# PRD - ç”¨æˆ·ç§¯åˆ†ç³»ç»Ÿ

> **ç‰ˆæœ¬**: v1.0
> **åˆ›å»ºæ—¥æœŸ**: 2025-10-30
> **è´Ÿè´£äºº**: Product Planner
> **ä¼˜å…ˆçº§**: P1

---

## 1. äº§å“æ¦‚è¿°

### 1.1 èƒŒæ™¯å’Œç›®æ ‡

**ä¸šåŠ¡èƒŒæ™¯**:
å½“å‰å¹³å°å·²å…·å¤‡å®Œæ•´çš„ä¼šå‘˜ä½“ç³»å’Œé…é¢ç³»ç»Ÿï¼Œä½†ç¼ºä¹ç”¨æˆ·æ—¥å¸¸æ´»è·ƒåº¦æ¿€åŠ±æœºåˆ¶ã€‚ç”¨æˆ·åœ¨éä»˜è´¹åœºæ™¯ä¸‹ç¼ºå°‘å‚ä¸æ„Ÿå’Œæˆå°±æ„Ÿï¼Œå¯¼è‡´ç”¨æˆ·ç•™å­˜ç‡å’Œæ´»è·ƒåº¦ä¸ç†æƒ³ã€‚

**æ ¸å¿ƒç›®æ ‡**:
1. **æå‡ç”¨æˆ·æ´»è·ƒåº¦**: é€šè¿‡æ¯æ—¥ç­¾åˆ°ã€ä»»åŠ¡ç³»ç»Ÿæ¿€åŠ±ç”¨æˆ·æ¯å¤©ç™»å½•ä½¿ç”¨
2. **å¢å¼ºç”¨æˆ·ç²˜æ€§**: ç§¯åˆ†ä½“ç³»å½¢æˆé•¿æœŸæ¿€åŠ±ï¼ŒåŸ¹å…»ç”¨æˆ·ä½¿ç”¨ä¹ æƒ¯
3. **é™ä½è·å®¢æˆæœ¬**: é€šè¿‡ç§¯åˆ†å…‘æ¢é…é¢/ä¼šå‘˜ï¼Œè®©ç”¨æˆ·ä½“éªŒä»˜è´¹åŠŸèƒ½ï¼Œæå‡è½¬åŒ–ç‡
4. **æ„å»ºç”¨æˆ·æˆé•¿ä½“ç³»**: ä¸ºæœªæ¥ä¼šå‘˜ç­‰çº§ã€ç”¨æˆ·å‹‹ç« ç­‰åŠŸèƒ½æ‰“ä¸‹åŸºç¡€

**æˆåŠŸæŒ‡æ ‡**:
- ç”¨æˆ·æ—¥æ´»è·ƒåº¦(DAU)æå‡30%
- ç”¨æˆ·7æ—¥ç•™å­˜ç‡æå‡20%
- ç§¯åˆ†å…‘æ¢é…é¢ä½¿ç”¨ç‡è¾¾åˆ°40%ä»¥ä¸Š
- ç§¯åˆ†å…‘æ¢ä¼šå‘˜è½¬åŒ–ç‡è¾¾åˆ°15%ä»¥ä¸Š

---

### 1.2 æ ¸å¿ƒä»·å€¼

**å¯¹ç”¨æˆ·**:
- å…è´¹è·å¾—å¤„ç†é…é¢ï¼Œé™ä½ä½¿ç”¨é—¨æ§›
- æ¯æ—¥ç­¾åˆ°è·å¾—å¥–åŠ±ï¼Œå¢å¼ºå‚ä¸æ„Ÿ
- å®Œæˆä»»åŠ¡è·å¾—ç§¯åˆ†ï¼Œä½“éªŒæˆå°±æ„Ÿ
- ç§¯åˆ†å•†åŸå…‘æ¢æƒç›Šï¼Œè·å¾—å®æƒ 

**å¯¹å¹³å°**:
- æå‡ç”¨æˆ·æ´»è·ƒåº¦å’Œç•™å­˜ç‡
- å¼•å¯¼ç”¨æˆ·ä½“éªŒä»˜è´¹åŠŸèƒ½ï¼Œæå‡è½¬åŒ–
- æ”¶é›†ç”¨æˆ·è¡Œä¸ºæ•°æ®ï¼Œä¼˜åŒ–äº§å“
- æ„å»ºç”¨æˆ·æˆé•¿ä½“ç³»ï¼Œå¢å¼ºå“ç‰Œå¿ è¯šåº¦

---

## 2. åŠŸèƒ½è¯¦ç»†è®¾è®¡

### 2.1 ç§¯åˆ†è´¦æˆ·ç³»ç»Ÿ

#### 2.1.1 ç§¯åˆ†è´¦æˆ·ç»“æ„

æ¯ä¸ªç”¨æˆ·è‡ªåŠ¨æ‹¥æœ‰ä¸€ä¸ªç§¯åˆ†è´¦æˆ·ï¼ŒåŒ…å«ä»¥ä¸‹å­—æ®µ:

```javascript
{
  user_id: "user_abc123",              // ç”¨æˆ·ID
  total_points: 1500,                   // ç´¯è®¡è·å¾—ç§¯åˆ†(å†å²æ€»å’Œ)
  available_points: 850,                // å¯ç”¨ç§¯åˆ†(å½“å‰å¯ä½¿ç”¨)
  frozen_points: 0,                     // å†»ç»“ç§¯åˆ†(å¼‚å¸¸è¡Œä¸ºå†»ç»“)
  used_points: 500,                     // å·²ä½¿ç”¨ç§¯åˆ†(å…‘æ¢æ¶ˆè€—)
  expired_points: 150,                  // å·²è¿‡æœŸç§¯åˆ†(è¿‡æœŸæ¸…é›¶)
  created_at: "2025-10-01 10:00:00",
  updated_at: "2025-10-30 15:30:00"
}
```

**æ•°æ®ä¸€è‡´æ€§æ ¡éªŒ**:
```
available_points = total_points - frozen_points - used_points - expired_points
```

---

#### 2.1.2 ç§¯åˆ†è®°å½•æµæ°´

æ‰€æœ‰ç§¯åˆ†å˜åŠ¨éƒ½è®°å½•åœ¨æµæ°´è¡¨ä¸­ï¼Œç¡®ä¿å¯è¿½æº¯:

```javascript
{
  id: "points_rec_xyz789",
  user_id: "user_abc123",
  change_type: "earn",                 // earn:è·å¾—, consume:æ¶ˆè€—, expire:è¿‡æœŸ, freeze:å†»ç»“, unfreeze:è§£å†»
  change_amount: 10,                   // å˜åŠ¨æ•°é‡(æ­£æ•°æˆ–è´Ÿæ•°)
  source_type: "checkin",              // register, checkin, task, purchase, redeem, invite, manual
  source_description: "è¿ç»­ç­¾åˆ°ç¬¬3å¤©",
  related_id: "checkin_20251030",      // å…³è”ID(ä»»åŠ¡ID/è®¢å•IDç­‰)
  balance_before: 840,                 // å˜åŠ¨å‰ä½™é¢
  balance_after: 850,                  // å˜åŠ¨åä½™é¢
  expire_at: "2026-10-30",             // è¿‡æœŸæ—¶é—´(è·å¾—ç§¯åˆ†æ—¶è®¾ç½®)
  created_at: "2025-10-30 08:00:00"
}
```

---

### 2.2 ç§¯åˆ†è·å–è§„åˆ™

#### 2.2.1 æ³¨å†Œå¥–åŠ±(ä¸€æ¬¡æ€§)

**è§„åˆ™**:
- æ–°ç”¨æˆ·æ³¨å†ŒæˆåŠŸåè‡ªåŠ¨å‘æ”¾100ç§¯åˆ†
- æ¯ä¸ªç”¨æˆ·ä»…èƒ½è·å¾—ä¸€æ¬¡
- ç§¯åˆ†æœ‰æ•ˆæœŸ365å¤©

**è§¦å‘æ—¶æœº**: ç”¨æˆ·æ³¨å†ŒæˆåŠŸåç«‹å³å‘æ”¾

**é˜²åˆ·æœºåˆ¶**:
- æ•°æ®åº“å”¯ä¸€çº¦æŸ: `UNIQUE KEY uk_user_register (user_id, source_type='register')`
- åç«¯ä»£ç æ£€æŸ¥: æ³¨å†Œå‰æŸ¥è¯¢è¯¥ç”¨æˆ·æ˜¯å¦å·²æœ‰æ³¨å†Œå¥–åŠ±è®°å½•

**ä»£ç ç¤ºä¾‹**:
```javascript
// ç”¨æˆ·æ³¨å†Œæ—¶è‡ªåŠ¨å‘æ”¾
async function grantRegistrationBonus(userId) {
  // æ£€æŸ¥æ˜¯å¦å·²å‘æ”¾
  const existing = await db('points_records')
    .where({ user_id: userId, source_type: 'register' })
    .first();

  if (existing) {
    return null; // å·²å‘æ”¾è¿‡
  }

  // å‘æ”¾100ç§¯åˆ†
  await db.transaction(async (trx) => {
    await grantPoints(trx, userId, 100, 'register', 'æ–°ç”¨æˆ·æ³¨å†Œå¥–åŠ±', null);
  });
}
```

---

#### 2.2.2 æ¯æ—¥ç­¾åˆ°

**è§„åˆ™**:
- **é¦–æ¬¡ç­¾åˆ°**: 2ç§¯åˆ†
- **è¿ç»­ç­¾åˆ°å¥–åŠ±**:
  - ç¬¬1å¤©: 2ç§¯åˆ†
  - ç¬¬2å¤©: 4ç§¯åˆ†
  - ç¬¬3å¤©: 6ç§¯åˆ†
  - ç¬¬4å¤©: 8ç§¯åˆ†
  - ç¬¬5å¤©åŠä»¥å: 10ç§¯åˆ†
- **ä¸­æ–­è§„åˆ™**: å¦‚æœä¸­æ–­ç­¾åˆ°,è¿ç»­å¤©æ•°æ¸…é›¶,é‡æ–°ä»ç¬¬1å¤©å¼€å§‹

**è§¦å‘æ—¶æœº**: ç”¨æˆ·ä¸»åŠ¨ç‚¹å‡»"ç­¾åˆ°"æŒ‰é’®

**é˜²åˆ·æœºåˆ¶**:
- å”¯ä¸€çº¦æŸ: `UNIQUE KEY uk_user_checkin_date (user_id, checkin_date)`
- åŒä¸€ç”¨æˆ·æ¯å¤©åªèƒ½ç­¾åˆ°ä¸€æ¬¡
- åç«¯æ ¡éªŒæœåŠ¡å™¨æ—¶é—´,ç¦æ­¢ç¯¡æ”¹å®¢æˆ·ç«¯æ—¶é—´

**ç­¾åˆ°è®°å½•è¡¨**:
```javascript
{
  id: "checkin_xyz789",
  user_id: "user_abc123",
  checkin_date: "2025-10-30",          // ç­¾åˆ°æ—¥æœŸ(DATEç±»å‹)
  consecutive_days: 3,                 // è¿ç»­ç­¾åˆ°å¤©æ•°
  points_earned: 6,                    // æœ¬æ¬¡è·å¾—ç§¯åˆ†
  created_at: "2025-10-30 08:00:00"
}
```

**ä»£ç ç¤ºä¾‹**:
```javascript
async function checkin(userId) {
  const today = moment().format('YYYY-MM-DD');

  // æ£€æŸ¥ä»Šå¤©æ˜¯å¦å·²ç­¾åˆ°
  const todayCheckin = await db('checkin_records')
    .where({ user_id: userId, checkin_date: today })
    .first();

  if (todayCheckin) {
    throw new Error('ä»Šå¤©å·²ç­¾åˆ°è¿‡äº†');
  }

  // æŸ¥è¯¢æ˜¨å¤©çš„ç­¾åˆ°è®°å½•
  const yesterday = moment().subtract(1, 'days').format('YYYY-MM-DD');
  const yesterdayCheckin = await db('checkin_records')
    .where({ user_id: userId, checkin_date: yesterday })
    .first();

  // è®¡ç®—è¿ç»­å¤©æ•°
  let consecutiveDays = 1;
  if (yesterdayCheckin) {
    consecutiveDays = yesterdayCheckin.consecutive_days + 1;
  }

  // è®¡ç®—ç§¯åˆ†(ç¬¬1-4å¤©é€’å¢,ç¬¬5å¤©åŠä»¥åå›ºå®š10ç§¯åˆ†)
  const pointsMap = { 1: 2, 2: 4, 3: 6, 4: 8 };
  const pointsEarned = consecutiveDays <= 4 ? pointsMap[consecutiveDays] : 10;

  // äº‹åŠ¡å¤„ç†
  await db.transaction(async (trx) => {
    // åˆ›å»ºç­¾åˆ°è®°å½•
    await trx('checkin_records').insert({
      user_id: userId,
      checkin_date: today,
      consecutive_days: consecutiveDays,
      points_earned: pointsEarned
    });

    // å‘æ”¾ç§¯åˆ†
    await grantPoints(trx, userId, pointsEarned, 'checkin', `è¿ç»­ç­¾åˆ°ç¬¬${consecutiveDays}å¤©`, `checkin_${today}`);
  });

  return { consecutiveDays, pointsEarned };
}
```

---

#### 2.2.3 ä»»åŠ¡ç§¯åˆ†

**ä»»åŠ¡åˆ—è¡¨**:

| ä»»åŠ¡åç§° | ç§¯åˆ†å¥–åŠ± | å®Œæˆæ¡ä»¶ | å¯é‡å¤ | é™åˆ¶ |
|---------|---------|---------|--------|------|
| å®Œå–„ä¸ªäººèµ„æ–™ | 20ç§¯åˆ† | å¡«å†™å¤´åƒ+æ˜µç§°+ç®€ä»‹ | å¦ | ä¸€æ¬¡æ€§ |
| é¦–æ¬¡ä½¿ç”¨AIåŠŸèƒ½ | 30ç§¯åˆ† | å®Œæˆ1æ¬¡å›¾ç‰‡/è§†é¢‘/æ–‡å­—å¤„ç† | å¦ | ä¸€æ¬¡æ€§ |
| åˆ†äº«ä½œå“ | 10ç§¯åˆ† | åˆ†äº«ä½œå“åˆ°å¾®ä¿¡/å¾®åš/æŠ–éŸ³ | æ˜¯ | æ¯å¤©é™3æ¬¡ |
| é‚€è¯·å¥½å‹æ³¨å†Œ | 50ç§¯åˆ† | é€šè¿‡ä¸“å±é“¾æ¥é‚€è¯·æ–°ç”¨æˆ·æ³¨å†Œ | æ˜¯ | æ¯æœˆé™5äºº |
| é¦–æ¬¡è´­ä¹°ä¼šå‘˜ | 100ç§¯åˆ† | è´­ä¹°ä»»æ„å¥—é¤ä¼šå‘˜ | å¦ | ä¸€æ¬¡æ€§ |
| è¯„ä»·AIç”Ÿæˆç»“æœ | 5ç§¯åˆ† | å¯¹ç”Ÿæˆç»“æœè¿›è¡Œè¯„åˆ†å’Œè¯„ä»· | æ˜¯ | æ¯å¤©é™10æ¬¡ |

**ä»»åŠ¡è®°å½•è¡¨**:
```javascript
{
  id: "task_comp_xyz789",
  user_id: "user_abc123",
  task_type: "profile_complete",      // profile_complete, first_use, share, invite, purchase, review
  task_description: "å®Œå–„ä¸ªäººèµ„æ–™",
  points_earned: 20,
  completed_at: "2025-10-30 10:00:00",
  related_id: null                     // å…³è”ID(é‚€è¯·çš„ç”¨æˆ·IDç­‰)
}
```

**é˜²åˆ·æœºåˆ¶**:
- **ä¸€æ¬¡æ€§ä»»åŠ¡**: å”¯ä¸€çº¦æŸ `UNIQUE KEY uk_user_task (user_id, task_type)` (ä»…å¯¹ä¸€æ¬¡æ€§ä»»åŠ¡)
- **æ¯æ—¥é™åˆ¶**: æŸ¥è¯¢å½“å¤©å®Œæˆæ¬¡æ•°,è¶…è¿‡é™åˆ¶åˆ™æ‹’ç»
- **æ¯æœˆé™åˆ¶**: æŸ¥è¯¢æœ¬æœˆå®Œæˆæ¬¡æ•°,è¶…è¿‡é™åˆ¶åˆ™æ‹’ç»
- **é‚€è¯·ä»»åŠ¡**: æ ¡éªŒæ¨èå…³ç³»çœŸå®æ€§,é˜²æ­¢åˆ·é‚€è¯·

**ä»£ç ç¤ºä¾‹**:
```javascript
async function completeTask(userId, taskType, relatedId = null) {
  const taskConfig = {
    'profile_complete': { points: 20, repeatable: false, description: 'å®Œå–„ä¸ªäººèµ„æ–™' },
    'first_use': { points: 30, repeatable: false, description: 'é¦–æ¬¡ä½¿ç”¨AIåŠŸèƒ½' },
    'share': { points: 10, repeatable: true, dailyLimit: 3, description: 'åˆ†äº«ä½œå“' },
    'invite': { points: 50, repeatable: true, monthlyLimit: 5, description: 'é‚€è¯·å¥½å‹æ³¨å†Œ' },
    'purchase': { points: 100, repeatable: false, description: 'é¦–æ¬¡è´­ä¹°ä¼šå‘˜' },
    'review': { points: 5, repeatable: true, dailyLimit: 10, description: 'è¯„ä»·AIç”Ÿæˆç»“æœ' }
  };

  const task = taskConfig[taskType];
  if (!task) {
    throw new Error('æ— æ•ˆçš„ä»»åŠ¡ç±»å‹');
  }

  // æ£€æŸ¥ä¸€æ¬¡æ€§ä»»åŠ¡æ˜¯å¦å·²å®Œæˆ
  if (!task.repeatable) {
    const existing = await db('task_completions')
      .where({ user_id: userId, task_type: taskType })
      .first();

    if (existing) {
      throw new Error('è¯¥ä»»åŠ¡å·²å®Œæˆ');
    }
  }

  // æ£€æŸ¥æ¯æ—¥é™åˆ¶
  if (task.dailyLimit) {
    const today = moment().format('YYYY-MM-DD');
    const count = await db('task_completions')
      .where({ user_id: userId, task_type: taskType })
      .where('completed_at', '>=', `${today} 00:00:00`)
      .count('id as count')
      .first();

    if (count.count >= task.dailyLimit) {
      throw new Error(`è¯¥ä»»åŠ¡æ¯å¤©æœ€å¤šå®Œæˆ${task.dailyLimit}æ¬¡`);
    }
  }

  // æ£€æŸ¥æ¯æœˆé™åˆ¶
  if (task.monthlyLimit) {
    const monthStart = moment().startOf('month').format('YYYY-MM-DD HH:mm:ss');
    const count = await db('task_completions')
      .where({ user_id: userId, task_type: taskType })
      .where('completed_at', '>=', monthStart)
      .count('id as count')
      .first();

    if (count.count >= task.monthlyLimit) {
      throw new Error(`è¯¥ä»»åŠ¡æ¯æœˆæœ€å¤šå®Œæˆ${task.monthlyLimit}æ¬¡`);
    }
  }

  // äº‹åŠ¡å¤„ç†
  await db.transaction(async (trx) => {
    // åˆ›å»ºä»»åŠ¡å®Œæˆè®°å½•
    await trx('task_completions').insert({
      user_id: userId,
      task_type: taskType,
      task_description: task.description,
      points_earned: task.points,
      related_id: relatedId
    });

    // å‘æ”¾ç§¯åˆ†
    await grantPoints(trx, userId, task.points, 'task', task.description, relatedId);
  });

  return { taskType, pointsEarned: task.points };
}
```

---

#### 2.2.4 æ¶ˆè´¹ç§¯åˆ†(è´­ä¹°ä¼šå‘˜)

**è§„åˆ™**:
- ç”¨æˆ·è´­ä¹°ä¼šå‘˜æ—¶,æŒ‰ç…§å……å€¼é‡‘é¢çš„1:10æ¯”ä¾‹èµ é€ç§¯åˆ†
- ä¾‹å¦‚: å……å€¼100å…ƒè´­ä¹°ä¼šå‘˜,èµ é€10ç§¯åˆ†
- ç§¯åˆ†åœ¨è®¢å•æ”¯ä»˜æˆåŠŸåç«‹å³å‘æ”¾
- é€€æ¬¾æ—¶æ‰£é™¤å·²å‘æ”¾çš„ç§¯åˆ†

**ç§¯åˆ†è®¡ç®—**:
```javascript
ç§¯åˆ† = Math.floor(è®¢å•å®ä»˜é‡‘é¢ / 10)
```

**è§¦å‘æ—¶æœº**: è®¢å•æ”¯ä»˜æˆåŠŸå›è°ƒæ—¶å‘æ”¾

**ä»£ç ç¤ºä¾‹**:
```javascript
async function grantPurchasePoints(orderId) {
  const order = await db('orders')
    .where({ id: orderId, status: 'paid' })
    .first();

  if (!order) {
    return null;
  }

  // æ£€æŸ¥æ˜¯å¦å·²å‘æ”¾
  const existing = await db('points_records')
    .where({ related_id: orderId, source_type: 'purchase' })
    .first();

  if (existing) {
    return null; // å·²å‘æ”¾è¿‡
  }

  // è®¡ç®—ç§¯åˆ†
  const pointsEarned = Math.floor(order.final_amount / 10);

  // å‘æ”¾ç§¯åˆ†
  await db.transaction(async (trx) => {
    await grantPoints(trx, order.user_id, pointsEarned, 'purchase', `è´­ä¹°ä¼šå‘˜èµ é€ç§¯åˆ†`, orderId);
  });

  return pointsEarned;
}
```

---

### 2.3 ç§¯åˆ†æ¶ˆè´¹è§„åˆ™

#### 2.3.1 ç§¯åˆ†å…‘æ¢é…é¢(æ ¸å¿ƒåŠŸèƒ½)

**å…‘æ¢è§„åˆ™**:
- **å…‘æ¢æ¯”ä¾‹**: 100ç§¯åˆ† = 1ä¸ªå¤„ç†é…é¢
- **æœ€ä½å…‘æ¢**: 100ç§¯åˆ†èµ·å…‘
- **å…‘æ¢é™åˆ¶**: æ¯æ¬¡æœ€å¤šå…‘æ¢50ä¸ªé…é¢(5000ç§¯åˆ†)
- **åˆ°è´¦æ—¶é—´**: ç«‹å³åˆ°è´¦

**å…‘æ¢æµç¨‹**:
```
ç”¨æˆ·é€‰æ‹©å…‘æ¢æ•°é‡ â†’ æ ¡éªŒç§¯åˆ†ä½™é¢ â†’ æ‰£é™¤ç§¯åˆ† â†’ å¢åŠ é…é¢ â†’ è®°å½•å…‘æ¢è®°å½•
```

**ä»£ç ç¤ºä¾‹**:
```javascript
async function redeemQuota(userId, quotaCount) {
  // æ ¡éªŒå…‘æ¢æ•°é‡
  if (quotaCount < 1 || quotaCount > 50) {
    throw new Error('å…‘æ¢æ•°é‡å¿…é¡»åœ¨1-50ä¹‹é—´');
  }

  const pointsRequired = quotaCount * 100;

  // äº‹åŠ¡å¤„ç†
  await db.transaction(async (trx) => {
    // 1. æŸ¥è¯¢ç§¯åˆ†è´¦æˆ·(åŠ è¡Œé”)
    const account = await trx('points_accounts')
      .where({ user_id: userId })
      .forUpdate()
      .first();

    if (!account || account.available_points < pointsRequired) {
      throw new Error('å¯ç”¨ç§¯åˆ†ä¸è¶³');
    }

    // 2. æ‰£é™¤ç§¯åˆ†
    await consumePoints(trx, userId, pointsRequired, 'redeem', `å…‘æ¢${quotaCount}ä¸ªå¤„ç†é…é¢`, null);

    // 3. å¢åŠ é…é¢
    await trx('users')
      .where({ id: userId })
      .increment('quota_balance', quotaCount);

    // 4. åˆ›å»ºå…‘æ¢è®°å½•
    await trx('points_redemptions').insert({
      user_id: userId,
      item_type: 'quota',
      item_name: `${quotaCount}ä¸ªå¤„ç†é…é¢`,
      points_cost: pointsRequired,
      item_value: quotaCount,
      status: 'completed'
    });
  });

  return { quotaCount, pointsCost: pointsRequired };
}
```

---

#### 2.3.2 ç§¯åˆ†å•†åŸå…‘æ¢

**å•†åŸå•†å“åˆ—è¡¨**:

| å•†å“åç§° | æ‰€éœ€ç§¯åˆ† | å•†å“ä»·å€¼ | åº“å­˜ | å…‘æ¢é™åˆ¶ |
|---------|---------|---------|------|---------|
| 50å…ƒä¼˜æƒ åˆ¸ | 500ç§¯åˆ† | 50å…ƒ | ä¸é™ | æ¯æœˆé™2å¼  |
| 100å…ƒä¼˜æƒ åˆ¸ | 900ç§¯åˆ† | 100å…ƒ | ä¸é™ | æ¯æœˆé™1å¼  |
| 1ä¸ªæœˆä¼šå‘˜ | 2000ç§¯åˆ† | ä»·å€¼99å…ƒ | ä¸é™ | ä¸é™ |
| 3ä¸ªæœˆä¼šå‘˜ | 5000ç§¯åˆ† | ä»·å€¼237å…ƒ | ä¸é™ | ä¸é™ |
| é«˜ä¼˜å…ˆçº§å¤„ç†ç‰¹æƒ(7å¤©) | 800ç§¯åˆ† | æ— ä»·æ ¼ | ä¸é™ | ä¸é™ |
| ä¸“å±å®¢æœé€šé“(30å¤©) | 1500ç§¯åˆ† | æ— ä»·æ ¼ | ä¸é™ | ä¸é™ |

**å•†å“è¡¨ç»“æ„**:
```javascript
{
  id: "item_abc123",
  item_type: "coupon",                // coupon:ä¼˜æƒ åˆ¸, membership:ä¼šå‘˜, privilege:ç‰¹æƒ
  item_name: "50å…ƒä¼˜æƒ åˆ¸",
  item_description: "é€‚ç”¨äºæ‰€æœ‰å¥—é¤,æœ‰æ•ˆæœŸ30å¤©",
  points_required: 500,
  item_value: 50,                     // ä¼˜æƒ åˆ¸é¢é¢æˆ–ä¼šå‘˜å¤©æ•°
  stock: -1,                          // -1è¡¨ç¤ºä¸é™åº“å­˜
  monthly_limit: 2,                   // æ¯æœˆå…‘æ¢æ¬¡æ•°é™åˆ¶, nullè¡¨ç¤ºä¸é™
  status: "active",                   // active:ä¸Šæ¶, soldout:å”®ç½„, inactive:ä¸‹æ¶
  image_url: "https://...",
  created_at: "2025-10-01 00:00:00"
}
```

**å…‘æ¢è®°å½•è¡¨**:
```javascript
{
  id: "redemption_xyz789",
  user_id: "user_abc123",
  item_id: "item_abc123",
  item_type: "coupon",
  item_name: "50å…ƒä¼˜æƒ åˆ¸",
  points_cost: 500,
  item_value: 50,
  status: "completed",                // completed:å·²å®Œæˆ, pending:å¤„ç†ä¸­, failed:å¤±è´¥
  coupon_code: "COUP-ABC123",         // ä¼˜æƒ åˆ¸ç (å¦‚æœæ˜¯ä¼˜æƒ åˆ¸)
  expire_at: "2025-11-30 23:59:59",   // ä¼˜æƒ åˆ¸è¿‡æœŸæ—¶é—´
  created_at: "2025-10-30 10:00:00"
}
```

**å…‘æ¢æµç¨‹**:
```javascript
async function redeemMallItem(userId, itemId) {
  // 1. æŸ¥è¯¢å•†å“ä¿¡æ¯
  const item = await db('points_mall_items')
    .where({ id: itemId, status: 'active' })
    .first();

  if (!item) {
    throw new Error('å•†å“ä¸å­˜åœ¨æˆ–å·²ä¸‹æ¶');
  }

  // 2. æ£€æŸ¥åº“å­˜
  if (item.stock !== -1 && item.stock <= 0) {
    throw new Error('å•†å“å·²å”®ç½„');
  }

  // 3. æ£€æŸ¥æ¯æœˆå…‘æ¢æ¬¡æ•°é™åˆ¶
  if (item.monthly_limit) {
    const monthStart = moment().startOf('month').format('YYYY-MM-DD HH:mm:ss');
    const count = await db('points_redemptions')
      .where({ user_id: userId, item_id: itemId })
      .where('created_at', '>=', monthStart)
      .count('id as count')
      .first();

    if (count.count >= item.monthly_limit) {
      throw new Error(`è¯¥å•†å“æ¯æœˆæœ€å¤šå…‘æ¢${item.monthly_limit}æ¬¡`);
    }
  }

  // 4. äº‹åŠ¡å¤„ç†
  await db.transaction(async (trx) => {
    // æŸ¥è¯¢ç§¯åˆ†è´¦æˆ·(åŠ è¡Œé”)
    const account = await trx('points_accounts')
      .where({ user_id: userId })
      .forUpdate()
      .first();

    if (!account || account.available_points < item.points_required) {
      throw new Error('å¯ç”¨ç§¯åˆ†ä¸è¶³');
    }

    // æ‰£é™¤ç§¯åˆ†
    await consumePoints(trx, userId, item.points_required, 'redeem', `å…‘æ¢${item.item_name}`, itemId);

    // æ‰£é™¤åº“å­˜(å¦‚æœæœ‰é™åˆ¶)
    if (item.stock !== -1) {
      await trx('points_mall_items')
        .where({ id: itemId })
        .decrement('stock', 1);
    }

    // åˆ›å»ºå…‘æ¢è®°å½•
    let couponCode = null;
    let expireAt = null;

    if (item.item_type === 'coupon') {
      // ç”Ÿæˆä¼˜æƒ åˆ¸ç 
      couponCode = `COUP-${uuidv4().substring(0, 8).toUpperCase()}`;
      expireAt = moment().add(30, 'days').format('YYYY-MM-DD 23:59:59');

      // åˆ›å»ºä¼˜æƒ åˆ¸
      await trx('coupons').insert({
        code: couponCode,
        user_id: userId,
        discount_type: 'fixed',
        discount_value: item.item_value,
        min_amount: 0,
        expire_at: expireAt,
        status: 'unused',
        source: 'points_redeem'
      });
    } else if (item.item_type === 'membership') {
      // å»¶é•¿ä¼šå‘˜æ—¶é•¿
      const user = await trx('users').where({ id: userId }).first();
      const currentExpireAt = user.membership_expire_at ? moment(user.membership_expire_at) : moment();
      const newExpireAt = currentExpireAt.add(item.item_value, 'days').format('YYYY-MM-DD HH:mm:ss');

      await trx('users')
        .where({ id: userId })
        .update({
          membership_type: 'premium',
          membership_expire_at: newExpireAt
        });
    }

    // åˆ›å»ºå…‘æ¢è®°å½•
    await trx('points_redemptions').insert({
      user_id: userId,
      item_id: itemId,
      item_type: item.item_type,
      item_name: item.item_name,
      points_cost: item.points_required,
      item_value: item.item_value,
      status: 'completed',
      coupon_code: couponCode,
      expire_at: expireAt
    });
  });

  return { itemName: item.item_name, pointsCost: item.points_required };
}
```

---

### 2.4 ç§¯åˆ†è¿‡æœŸæœºåˆ¶

#### 2.4.1 è¿‡æœŸè§„åˆ™

**æœ‰æ•ˆæœŸ**:
- æ‰€æœ‰ç§¯åˆ†è·å¾—åæœ‰æ•ˆæœŸä¸º365å¤©
- è¿‡æœŸæ—¶é—´åœ¨ç§¯åˆ†è®°å½•åˆ›å»ºæ—¶è®¾ç½®(`expire_at`å­—æ®µ)

**æ¶ˆè´¹é¡ºåº(FIFO)**:
- æ¶ˆè´¹ç§¯åˆ†æ—¶,ä¼˜å…ˆæ¶ˆè€—å³å°†è¿‡æœŸçš„ç§¯åˆ†
- æŒ‰ç…§`expire_at`å‡åºæ’åˆ—,ä¾æ¬¡æ‰£å‡

**å®šæ—¶æ¸…ç†**:
- æ¯å¤©å‡Œæ™¨3ç‚¹æ‰§è¡Œå®šæ—¶ä»»åŠ¡
- æ‰«ææ‰€æœ‰å·²è¿‡æœŸä½†æœªæ ‡è®°çš„ç§¯åˆ†è®°å½•
- æ›´æ–°ç§¯åˆ†è´¦æˆ·çš„`expired_points`å­—æ®µ

---

#### 2.4.2 è¿‡æœŸå¤„ç†æµç¨‹

**å®šæ—¶ä»»åŠ¡ä»£ç **:
```javascript
// æ¯å¤©å‡Œæ™¨3ç‚¹æ‰§è¡Œ
async function expirePoints() {
  const today = moment().format('YYYY-MM-DD');

  // æŸ¥è¯¢æ‰€æœ‰å·²è¿‡æœŸçš„ç§¯åˆ†è®°å½•
  const expiredRecords = await db('points_records')
    .where('expire_at', '<', today)
    .where('change_type', 'earn')
    .where('is_expired', false)
    .select('*');

  if (expiredRecords.length === 0) {
    return;
  }

  // æŒ‰ç”¨æˆ·åˆ†ç»„
  const groupedByUser = {};
  expiredRecords.forEach(record => {
    if (!groupedByUser[record.user_id]) {
      groupedByUser[record.user_id] = [];
    }
    groupedByUser[record.user_id].push(record);
  });

  // é€ç”¨æˆ·å¤„ç†
  for (const userId in groupedByUser) {
    const records = groupedByUser[userId];
    const totalExpired = records.reduce((sum, r) => sum + r.change_amount, 0);

    await db.transaction(async (trx) => {
      // æ ‡è®°ç§¯åˆ†è®°å½•ä¸ºå·²è¿‡æœŸ
      const recordIds = records.map(r => r.id);
      await trx('points_records')
        .whereIn('id', recordIds)
        .update({ is_expired: true });

      // æ›´æ–°ç§¯åˆ†è´¦æˆ·
      await trx('points_accounts')
        .where({ user_id: userId })
        .increment('expired_points', totalExpired)
        .decrement('available_points', totalExpired);

      // åˆ›å»ºè¿‡æœŸæµæ°´è®°å½•
      await trx('points_records').insert({
        user_id: userId,
        change_type: 'expire',
        change_amount: -totalExpired,
        source_type: 'system',
        source_description: `ç§¯åˆ†è¿‡æœŸ(${records.length}æ¡è®°å½•)`,
        related_id: null,
        balance_before: 0,
        balance_after: 0
      });
    });

    logger.info(`[PointsExpire] ç”¨æˆ·${userId}è¿‡æœŸç§¯åˆ†${totalExpired},æ¶‰åŠ${records.length}æ¡è®°å½•`);
  }
}
```

---

#### 2.4.3 FIFOæ¶ˆè´¹é€»è¾‘

**æ¶ˆè´¹ç§¯åˆ†æ—¶ä¼˜å…ˆæ‰£é™¤å³å°†è¿‡æœŸçš„ç§¯åˆ†**:

```javascript
async function consumePoints(trx, userId, amount, sourceType, description, relatedId) {
  // 1. æŸ¥è¯¢ç§¯åˆ†è´¦æˆ·(åŠ è¡Œé”)
  const account = await trx('points_accounts')
    .where({ user_id: userId })
    .forUpdate()
    .first();

  if (!account || account.available_points < amount) {
    throw new Error('å¯ç”¨ç§¯åˆ†ä¸è¶³');
  }

  // 2. æŸ¥è¯¢å¯ç”¨ç§¯åˆ†è®°å½•(æŒ‰è¿‡æœŸæ—¶é—´å‡åº,FIFO)
  const availableRecords = await trx('points_records')
    .where({ user_id: userId, change_type: 'earn', is_expired: false })
    .where('expire_at', '>=', moment().format('YYYY-MM-DD'))
    .orderBy('expire_at', 'asc')
    .select('*');

  // 3. æŒ‰FIFOé¡ºåºæ‰£å‡ç§¯åˆ†
  let remainingAmount = amount;
  const consumedRecords = [];

  for (const record of availableRecords) {
    if (remainingAmount <= 0) break;

    // è®¡ç®—è¯¥è®°å½•å·²è¢«æ¶ˆè´¹çš„ç§¯åˆ†
    const consumed = await trx('points_consumptions')
      .where({ earn_record_id: record.id })
      .sum('consumed_amount as total')
      .first();

    const alreadyConsumed = consumed.total || 0;
    const availableInRecord = record.change_amount - alreadyConsumed;

    if (availableInRecord <= 0) continue;

    // è®¡ç®—æœ¬æ¬¡ä»è¯¥è®°å½•æ‰£å‡çš„ç§¯åˆ†
    const toConsume = Math.min(remainingAmount, availableInRecord);

    // åˆ›å»ºæ¶ˆè´¹å…³è”è®°å½•
    await trx('points_consumptions').insert({
      user_id: userId,
      earn_record_id: record.id,
      consumed_amount: toConsume,
      consume_type: sourceType,
      consume_description: description,
      related_id: relatedId
    });

    consumedRecords.push({ recordId: record.id, amount: toConsume, expireAt: record.expire_at });
    remainingAmount -= toConsume;
  }

  if (remainingAmount > 0) {
    throw new Error('å¯ç”¨ç§¯åˆ†ä¸è¶³(FIFOæ‰£å‡å¤±è´¥)');
  }

  // 4. æ›´æ–°ç§¯åˆ†è´¦æˆ·
  await trx('points_accounts')
    .where({ user_id: userId })
    .decrement('available_points', amount)
    .increment('used_points', amount);

  // 5. åˆ›å»ºæ¶ˆè´¹æµæ°´è®°å½•
  await trx('points_records').insert({
    user_id: userId,
    change_type: 'consume',
    change_amount: -amount,
    source_type: sourceType,
    source_description: description,
    related_id: relatedId,
    balance_before: account.available_points,
    balance_after: account.available_points - amount
  });

  logger.info(`[PointsConsume] ç”¨æˆ·${userId}æ¶ˆè´¹ç§¯åˆ†${amount},æ¶‰åŠ${consumedRecords.length}æ¡è®°å½•`, consumedRecords);
}
```

---

### 2.5 é˜²åˆ·æœºåˆ¶å’Œå®‰å…¨æ€§

#### 2.5.1 é˜²åˆ·ç­–ç•¥

**1. æ¯æ—¥ç­¾åˆ°é˜²åˆ·**:
- æ•°æ®åº“å”¯ä¸€çº¦æŸ: `UNIQUE KEY uk_user_checkin_date (user_id, checkin_date)`
- åç«¯æ ¡éªŒæœåŠ¡å™¨æ—¶é—´,æ‹’ç»å®¢æˆ·ç«¯æ—¶é—´ç¯¡æ”¹
- åŒä¸€è®¾å¤‡/IPæ¯å¤©åªèƒ½ç­¾åˆ°ä¸€æ¬¡(åå°ç›‘æ§å¼‚å¸¸)

**2. ä»»åŠ¡å®Œæˆé˜²åˆ·**:
- ä¸€æ¬¡æ€§ä»»åŠ¡: æ•°æ®åº“å”¯ä¸€çº¦æŸé˜²æ­¢é‡å¤å®Œæˆ
- å¯é‡å¤ä»»åŠ¡: åç«¯æ ¡éªŒæ¯æ—¥/æ¯æœˆå®Œæˆæ¬¡æ•°é™åˆ¶
- é‚€è¯·ä»»åŠ¡: æ ¡éªŒæ¨èå…³ç³»çœŸå®æ€§,é˜²æ­¢è™šå‡é‚€è¯·

**3. å…‘æ¢é˜²åˆ·**:
- ä½¿ç”¨è¡Œé”(`forUpdate()`)é˜²æ­¢å¹¶å‘è¶…æ‰£
- äº‹åŠ¡å®Œæ•´æ€§ä¿è¯æ‰£é™¤ç§¯åˆ†å’Œå¢åŠ é…é¢åŸå­æ€§
- å…‘æ¢è®°å½•é˜²é‡æ”¾æ”»å‡»(æ£€æŸ¥é‡å¤æäº¤)

**4. å¼‚å¸¸è¡Œä¸ºç›‘æ§**:
- çŸ­æ—¶é—´å†…å¤§é‡ç§¯åˆ†è·å–(å¦‚1å°æ—¶å†…è·å¾—>500ç§¯åˆ†)
- çŸ­æ—¶é—´å†…å¤§é‡ç§¯åˆ†æ¶ˆè´¹(å¦‚5åˆ†é’Ÿå†…æ¶ˆè´¹>5000ç§¯åˆ†)
- åŒä¸€IP/è®¾å¤‡å¤šè´¦å·ç­¾åˆ°
- è‡ªæ¨è‡ªä¹°(é‚€è¯·è‡ªå·±æ³¨å†Œçš„å°å·)

---

#### 2.5.2 ç§¯åˆ†å†»ç»“æœºåˆ¶

**è§¦å‘æ¡ä»¶**:
- ç³»ç»Ÿæ£€æµ‹åˆ°å¼‚å¸¸è¡Œä¸º
- äººå·¥å®¡æ ¸å‘ç°åˆ·ç§¯åˆ†è¡Œä¸º
- ç”¨æˆ·æ¶æ„é€€æ¬¾åä»æŒæœ‰ç§¯åˆ†

**å†»ç»“æµç¨‹**:
```javascript
async function freezePoints(userId, amount, reason) {
  await db.transaction(async (trx) => {
    // 1. æŸ¥è¯¢ç§¯åˆ†è´¦æˆ·(åŠ è¡Œé”)
    const account = await trx('points_accounts')
      .where({ user_id: userId })
      .forUpdate()
      .first();

    if (!account || account.available_points < amount) {
      throw new Error('å¯ç”¨ç§¯åˆ†ä¸è¶³');
    }

    // 2. æ›´æ–°ç§¯åˆ†è´¦æˆ·
    await trx('points_accounts')
      .where({ user_id: userId })
      .decrement('available_points', amount)
      .increment('frozen_points', amount);

    // 3. åˆ›å»ºå†»ç»“æµæ°´è®°å½•
    await trx('points_records').insert({
      user_id: userId,
      change_type: 'freeze',
      change_amount: -amount,
      source_type: 'system',
      source_description: reason,
      related_id: null,
      balance_before: account.available_points,
      balance_after: account.available_points - amount
    });
  });

  logger.warn(`[PointsFreeze] ç”¨æˆ·${userId}å†»ç»“ç§¯åˆ†${amount},åŸå› :${reason}`);
}
```

**è§£å†»æµç¨‹**:
```javascript
async function unfreezePoints(userId, amount, reason) {
  await db.transaction(async (trx) => {
    const account = await trx('points_accounts')
      .where({ user_id: userId })
      .forUpdate()
      .first();

    if (!account || account.frozen_points < amount) {
      throw new Error('å†»ç»“ç§¯åˆ†ä¸è¶³');
    }

    await trx('points_accounts')
      .where({ user_id: userId })
      .increment('available_points', amount)
      .decrement('frozen_points', amount);

    await trx('points_records').insert({
      user_id: userId,
      change_type: 'unfreeze',
      change_amount: amount,
      source_type: 'system',
      source_description: reason,
      related_id: null,
      balance_before: account.available_points,
      balance_after: account.available_points + amount
    });
  });

  logger.info(`[PointsUnfreeze] ç”¨æˆ·${userId}è§£å†»ç§¯åˆ†${amount},åŸå› :${reason}`);
}
```

---

## 3. ç”¨æˆ·ç•Œé¢è®¾è®¡

### 3.1 ç”¨æˆ·ç«¯é¡µé¢

#### 3.1.1 ç§¯åˆ†ä¸­å¿ƒé¦–é¡µ

**è·¯ç”±**: `/points`

**é¡µé¢ç»“æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [è¿”å›]  ç§¯åˆ†ä¸­å¿ƒ                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  æˆ‘çš„ç§¯åˆ†                             â”‚  â”‚
â”‚  â”‚  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•  â”‚  â”‚
â”‚  â”‚  å¯ç”¨ç§¯åˆ†: 850                        â”‚  â”‚
â”‚  â”‚  ç´¯è®¡è·å¾—: 1,500                      â”‚  â”‚
â”‚  â”‚  å·²ä½¿ç”¨: 500 | å·²è¿‡æœŸ: 150            â”‚  â”‚
â”‚  â”‚                                       â”‚  â”‚
â”‚  â”‚  [å…‘æ¢é…é¢] [ç§¯åˆ†å•†åŸ] [ç§¯åˆ†æ˜ç»†]      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ“… æ¯æ—¥ç­¾åˆ°                          â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚  â”‚
â”‚  â”‚  è¿ç»­ç­¾åˆ°3å¤©,ä»Šæ—¥å¯è·å¾—6ç§¯åˆ†          â”‚  â”‚
â”‚  â”‚  [ç«‹å³ç­¾åˆ°]                           â”‚  â”‚
â”‚  â”‚                                       â”‚  â”‚
â”‚  â”‚  ç­¾åˆ°æ—¥å†: ä¸€ äºŒ ä¸‰ å›› äº” å…­ æ—¥       â”‚  â”‚
â”‚  â”‚           âœ… âœ… âœ… â­• â­• â­• â­•      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ¯ ä»»åŠ¡ä¸­å¿ƒ                          â”‚  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€   â”‚  â”‚
â”‚  â”‚  âœ… å®Œå–„ä¸ªäººèµ„æ–™         +20ç§¯åˆ†      â”‚  â”‚
â”‚  â”‚  âœ… é¦–æ¬¡ä½¿ç”¨AIåŠŸèƒ½       +30ç§¯åˆ†      â”‚  â”‚
â”‚  â”‚  ğŸ”„ åˆ†äº«ä½œå“(ä»Šæ—¥0/3)    +10ç§¯åˆ†/æ¬¡   â”‚  â”‚
â”‚  â”‚  ğŸ”„ é‚€è¯·å¥½å‹(æœ¬æœˆ2/5)    +50ç§¯åˆ†/äºº   â”‚  â”‚
â”‚  â”‚  â­• é¦–æ¬¡è´­ä¹°ä¼šå‘˜         +100ç§¯åˆ†      â”‚  â”‚
â”‚  â”‚  ğŸ”„ è¯„ä»·ç”Ÿæˆç»“æœ(0/10)   +5ç§¯åˆ†/æ¬¡    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**åŠŸèƒ½è¦ç‚¹**:
- é¡¶éƒ¨å±•ç¤ºç§¯åˆ†è´¦æˆ·æ ¸å¿ƒæ•°æ®(å¯ç”¨ã€ç´¯è®¡ã€å·²ä½¿ç”¨ã€å·²è¿‡æœŸ)
- æ¯æ—¥ç­¾åˆ°å¡ç‰‡æ˜¾ç¤ºè¿ç»­ç­¾åˆ°å¤©æ•°å’Œä»Šæ—¥å¯è·å¾—ç§¯åˆ†
- ç­¾åˆ°æ—¥å†å±•ç¤ºæœ¬å‘¨ç­¾åˆ°æƒ…å†µ(âœ…å·²ç­¾åˆ°, â­•æœªç­¾åˆ°)
- ä»»åŠ¡ä¸­å¿ƒå±•ç¤ºæ‰€æœ‰ä»»åŠ¡åŠå®ŒæˆçŠ¶æ€(âœ…å·²å®Œæˆ, ğŸ”„è¿›è¡Œä¸­, â­•æœªå¼€å§‹)

---

#### 3.1.2 å…‘æ¢é…é¢é¡µ

**è·¯ç”±**: `/points/redeem-quota`

**é¡µé¢ç»“æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [è¿”å›]  å…‘æ¢é…é¢                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                             â”‚
â”‚  å½“å‰å¯ç”¨ç§¯åˆ†: 850                          â”‚
â”‚  å…‘æ¢æ¯”ä¾‹: 100ç§¯åˆ† = 1ä¸ªå¤„ç†é…é¢             â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  å…‘æ¢æ•°é‡                             â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚ [  8  ] ä¸ªé…é¢                  â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                                       â”‚  â”‚
â”‚  â”‚  éœ€è¦ç§¯åˆ†: 800                        â”‚  â”‚
â”‚  â”‚  å‰©ä½™ç§¯åˆ†: 50                         â”‚  â”‚
â”‚  â”‚                                       â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚  â”‚
â”‚  â”‚  â”‚  ç¡®è®¤å…‘æ¢          â”‚              â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                             â”‚
â”‚  å…‘æ¢è¯´æ˜:                                  â”‚
â”‚  â€¢ æœ€ä½å…‘æ¢100ç§¯åˆ†(1ä¸ªé…é¢)                 â”‚
â”‚  â€¢ æ¯æ¬¡æœ€å¤šå…‘æ¢50ä¸ªé…é¢(5000ç§¯åˆ†)           â”‚
â”‚  â€¢ å…‘æ¢åé…é¢ç«‹å³åˆ°è´¦                       â”‚
â”‚  â€¢ é…é¢æœ‰æ•ˆæœŸä¸ä¼šå‘˜æ—¶é•¿ä¸€è‡´                 â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### 3.1.3 ç§¯åˆ†å•†åŸé¡µ

**è·¯ç”±**: `/points/mall`

**é¡µé¢ç»“æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [è¿”å›]  ç§¯åˆ†å•†åŸ                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  å¯ç”¨ç§¯åˆ†: 850                              â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ 50å…ƒä¼˜æƒ åˆ¸  â”‚  â”‚ 100å…ƒä¼˜æƒ åˆ¸ â”‚         â”‚
â”‚  â”‚             â”‚  â”‚             â”‚         â”‚
â”‚  â”‚ 500ç§¯åˆ†     â”‚  â”‚ 900ç§¯åˆ†     â”‚         â”‚
â”‚  â”‚ æ¯æœˆé™2å¼    â”‚  â”‚ æ¯æœˆé™1å¼    â”‚         â”‚
â”‚  â”‚ [ç«‹å³å…‘æ¢]  â”‚  â”‚ [ç«‹å³å…‘æ¢]  â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ 1ä¸ªæœˆä¼šå‘˜   â”‚  â”‚ 3ä¸ªæœˆä¼šå‘˜   â”‚         â”‚
â”‚  â”‚             â”‚  â”‚             â”‚         â”‚
â”‚  â”‚ 2000ç§¯åˆ†    â”‚  â”‚ 5000ç§¯åˆ†    â”‚         â”‚
â”‚  â”‚ ä»·å€¼99å…ƒ    â”‚  â”‚ ä»·å€¼237å…ƒ   â”‚         â”‚
â”‚  â”‚ [ç«‹å³å…‘æ¢]  â”‚  â”‚ [ç«‹å³å…‘æ¢]  â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ é«˜ä¼˜å…ˆçº§    â”‚  â”‚ ä¸“å±å®¢æœ    â”‚         â”‚
â”‚  â”‚ å¤„ç†ç‰¹æƒ    â”‚  â”‚ é€šé“        â”‚         â”‚
â”‚  â”‚ 800ç§¯åˆ†     â”‚  â”‚ 1500ç§¯åˆ†    â”‚         â”‚
â”‚  â”‚ æœ‰æ•ˆæœŸ7å¤©   â”‚  â”‚ æœ‰æ•ˆæœŸ30å¤©  â”‚         â”‚
â”‚  â”‚ [ç«‹å³å…‘æ¢]  â”‚  â”‚ [ç«‹å³å…‘æ¢]  â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### 3.1.4 ç§¯åˆ†æ˜ç»†é¡µ

**è·¯ç”±**: `/points/records`

**é¡µé¢ç»“æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [è¿”å›]  ç§¯åˆ†æ˜ç»†                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [å…¨éƒ¨] [è·å¾—] [æ¶ˆè´¹] [è¿‡æœŸ]                 â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ è¿ç»­ç­¾åˆ°ç¬¬3å¤©              +6ç§¯åˆ†     â”‚  â”‚
â”‚  â”‚ 2025-10-30 08:00         æœ‰æ•ˆæœŸ365å¤©  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ å…‘æ¢8ä¸ªå¤„ç†é…é¢            -800ç§¯åˆ†    â”‚  â”‚
â”‚  â”‚ 2025-10-30 10:00                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ å®Œå–„ä¸ªäººèµ„æ–™               +20ç§¯åˆ†     â”‚  â”‚
â”‚  â”‚ 2025-10-29 15:30         æœ‰æ•ˆæœŸ365å¤©  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ç§¯åˆ†è¿‡æœŸ                   -10ç§¯åˆ†     â”‚  â”‚
â”‚  â”‚ 2025-10-28 03:00                      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 3.2 ç®¡ç†å‘˜ç«¯é¡µé¢

#### 3.2.1 ç§¯åˆ†ç»Ÿè®¡å¤§ç›˜

**è·¯ç”±**: `/admin/points/dashboard`

**é¡µé¢ç»“æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç§¯åˆ†ç³»ç»Ÿæ•°æ®å¤§ç›˜                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚æ€»å‘æ”¾ç§¯åˆ†â”‚ â”‚æ€»æ¶ˆè´¹ç§¯åˆ†â”‚ â”‚è¿‡æœŸç§¯åˆ†  â”‚   â”‚
â”‚  â”‚ 1,250,000â”‚ â”‚  850,000 â”‚ â”‚  50,000  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ç­¾åˆ°äººæ¬¡  â”‚ â”‚å…‘æ¢é…é¢  â”‚ â”‚å…‘æ¢ä¼šå‘˜  â”‚   â”‚
â”‚  â”‚  8,500   â”‚ â”‚  2,150   â”‚ â”‚   320    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                             â”‚
â”‚  ğŸ“Š ç§¯åˆ†å‘æ”¾è¶‹åŠ¿å›¾(æœ€è¿‘30å¤©)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                        ğŸ“ˆ             â”‚  â”‚
â”‚  â”‚            ğŸ“ˆ  ğŸ“ˆ                     â”‚  â”‚
â”‚  â”‚      ğŸ“ˆ                               â”‚  â”‚
â”‚  â”‚ ğŸ“ˆ                                    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                             â”‚
â”‚  ğŸ“Š ç§¯åˆ†æ¶ˆè´¹åˆ†å¸ƒ(æŒ‰ç±»å‹)                    â”‚
â”‚  â€¢ å…‘æ¢é…é¢: 65%                            â”‚
â”‚  â€¢ å…‘æ¢ä¼˜æƒ åˆ¸: 20%                          â”‚
â”‚  â€¢ å…‘æ¢ä¼šå‘˜: 15%                            â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### 3.2.2 ç”¨æˆ·ç§¯åˆ†ç®¡ç†

**è·¯ç”±**: `/admin/points/users`

**é¡µé¢ç»“æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ·ç§¯åˆ†ç®¡ç†                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æœç´¢: [ç”¨æˆ·ID/æ‰‹æœºå·]  [æœç´¢]               â”‚
â”‚                                             â”‚
â”‚  ç”¨æˆ·åˆ—è¡¨:                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ç”¨æˆ·ID | æ‰‹æœºå· | å¯ç”¨ç§¯åˆ† | æ“ä½œ     â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ user_123 | 138*8888 | 850 | [è¯¦æƒ…]  â”‚  â”‚
â”‚  â”‚ user_456 | 139*9999 | 1200 | [è¯¦æƒ…] â”‚  â”‚
â”‚  â”‚ user_789 | 137*7777 | 300 | [è¯¦æƒ…]  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                             â”‚
â”‚  [æ‰‹åŠ¨è°ƒæ•´ç§¯åˆ†] [å†»ç»“ç§¯åˆ†] [è§£å†»ç§¯åˆ†]        â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### 3.2.3 ç§¯åˆ†å•†åŸç®¡ç†

**è·¯ç”±**: `/admin/points/mall`

**é¡µé¢ç»“æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç§¯åˆ†å•†åŸç®¡ç†                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [æ–°å¢å•†å“]                                  â”‚
â”‚                                             â”‚
â”‚  å•†å“åˆ—è¡¨:                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ å•†å“åç§° | æ‰€éœ€ç§¯åˆ† | çŠ¶æ€ | æ“ä½œ     â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ 50å…ƒä¼˜æƒ åˆ¸ | 500 | ä¸Šæ¶ | [ç¼–è¾‘][ä¸‹æ¶]â”‚  â”‚
â”‚  â”‚ 1ä¸ªæœˆä¼šå‘˜ | 2000 | ä¸Šæ¶ | [ç¼–è¾‘][ä¸‹æ¶]â”‚  â”‚
â”‚  â”‚ é«˜ä¼˜å…ˆçº§å¤„ç† | 800 | ä¸Šæ¶ | [ç¼–è¾‘][ä¸‹æ¶]â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

#### 3.2.4 ç§¯åˆ†è®¾ç½®é¡µ

**è·¯ç”±**: `/admin/points/settings`

**é¡µé¢ç»“æ„**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç§¯åˆ†ç³»ç»Ÿè®¾ç½®                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  åŸºç¡€è®¾ç½®:                                  â”‚
â”‚  â€¢ ç§¯åˆ†æœ‰æ•ˆæœŸ: [365] å¤©                     â”‚
â”‚  â€¢ è´­ä¹°ä¼šå‘˜ç§¯åˆ†æ¯”ä¾‹: 1: [10] (å……å€¼é‡‘é¢:ç§¯åˆ†) â”‚
â”‚  â€¢ ç§¯åˆ†å…‘æ¢é…é¢æ¯”ä¾‹: [100] ç§¯åˆ† = 1ä¸ªé…é¢   â”‚
â”‚                                             â”‚
â”‚  ç­¾åˆ°è®¾ç½®:                                  â”‚
â”‚  â€¢ é¦–æ¬¡ç­¾åˆ°: [2] ç§¯åˆ†                       â”‚
â”‚  â€¢ è¿ç»­ç­¾åˆ°é€’å¢: âœ… å¯ç”¨                    â”‚
â”‚  â€¢ ç¬¬5å¤©åŠä»¥å: [10] ç§¯åˆ†                   â”‚
â”‚                                             â”‚
â”‚  ä»»åŠ¡è®¾ç½®:                                  â”‚
â”‚  â€¢ æ³¨å†Œå¥–åŠ±: [100] ç§¯åˆ†                     â”‚
â”‚  â€¢ å®Œå–„èµ„æ–™: [20] ç§¯åˆ†                      â”‚
â”‚  â€¢ é¦–æ¬¡ä½¿ç”¨: [30] ç§¯åˆ†                      â”‚
â”‚  â€¢ åˆ†äº«ä½œå“: [10] ç§¯åˆ†(æ¯å¤©é™[3]æ¬¡)         â”‚
â”‚  â€¢ é‚€è¯·å¥½å‹: [50] ç§¯åˆ†(æ¯æœˆé™[5]äºº)         â”‚
â”‚                                             â”‚
â”‚  [ä¿å­˜è®¾ç½®]                                 â”‚
â”‚                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 4. æ•°æ®åº“è®¾è®¡

### 4.1 è¡¨ç»“æ„è®¾è®¡

#### 4.1.1 ç§¯åˆ†è´¦æˆ·è¡¨(points_accounts)

```sql
CREATE TABLE `points_accounts` (
  `user_id` VARCHAR(50) NOT NULL COMMENT 'ç”¨æˆ·ID',
  `total_points` INT NOT NULL DEFAULT 0 COMMENT 'ç´¯è®¡è·å¾—ç§¯åˆ†',
  `available_points` INT NOT NULL DEFAULT 0 COMMENT 'å¯ç”¨ç§¯åˆ†',
  `frozen_points` INT NOT NULL DEFAULT 0 COMMENT 'å†»ç»“ç§¯åˆ†',
  `used_points` INT NOT NULL DEFAULT 0 COMMENT 'å·²ä½¿ç”¨ç§¯åˆ†',
  `expired_points` INT NOT NULL DEFAULT 0 COMMENT 'å·²è¿‡æœŸç§¯åˆ†',
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
  PRIMARY KEY (`user_id`),
  INDEX `idx_available_points` (`available_points`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç§¯åˆ†è´¦æˆ·è¡¨';
```

**å­—æ®µè¯´æ˜**:
- `user_id`: ç”¨æˆ·ID(ä¸»é”®)
- `total_points`: ç´¯è®¡è·å¾—ç§¯åˆ†(å†å²æ€»å’Œ,åªå¢ä¸å‡)
- `available_points`: å¯ç”¨ç§¯åˆ†(å½“å‰å¯ä½¿ç”¨çš„ç§¯åˆ†)
- `frozen_points`: å†»ç»“ç§¯åˆ†(å¼‚å¸¸è¡Œä¸ºå†»ç»“çš„ç§¯åˆ†)
- `used_points`: å·²ä½¿ç”¨ç§¯åˆ†(å…‘æ¢æ¶ˆè€—çš„ç§¯åˆ†)
- `expired_points`: å·²è¿‡æœŸç§¯åˆ†(è¿‡æœŸæ¸…é›¶çš„ç§¯åˆ†)

**æ•°æ®ä¸€è‡´æ€§**:
```sql
available_points = total_points - frozen_points - used_points - expired_points
```

---

#### 4.1.2 ç§¯åˆ†è®°å½•è¡¨(points_records)

```sql
CREATE TABLE `points_records` (
  `id` VARCHAR(50) NOT NULL COMMENT 'è®°å½•ID',
  `user_id` VARCHAR(50) NOT NULL COMMENT 'ç”¨æˆ·ID',
  `change_type` ENUM('earn', 'consume', 'expire', 'freeze', 'unfreeze') NOT NULL COMMENT 'å˜åŠ¨ç±»å‹',
  `change_amount` INT NOT NULL COMMENT 'å˜åŠ¨æ•°é‡(æ­£æ•°æˆ–è´Ÿæ•°)',
  `source_type` VARCHAR(50) NOT NULL COMMENT 'æ¥æºç±»å‹:register,checkin,task,purchase,redeem,invite,manual,system',
  `source_description` VARCHAR(200) NOT NULL COMMENT 'æ¥æºæè¿°',
  `related_id` VARCHAR(50) DEFAULT NULL COMMENT 'å…³è”ID(ä»»åŠ¡ID/è®¢å•IDç­‰)',
  `balance_before` INT NOT NULL COMMENT 'å˜åŠ¨å‰ä½™é¢',
  `balance_after` INT NOT NULL COMMENT 'å˜åŠ¨åä½™é¢',
  `expire_at` DATE DEFAULT NULL COMMENT 'è¿‡æœŸæ—¶é—´(è·å¾—ç§¯åˆ†æ—¶è®¾ç½®)',
  `is_expired` TINYINT(1) NOT NULL DEFAULT 0 COMMENT 'æ˜¯å¦å·²è¿‡æœŸ(0:æœªè¿‡æœŸ, 1:å·²è¿‡æœŸ)',
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  PRIMARY KEY (`id`),
  INDEX `idx_user_id` (`user_id`),
  INDEX `idx_change_type` (`change_type`),
  INDEX `idx_expire_at` (`expire_at`, `is_expired`),
  INDEX `idx_created_at` (`created_at`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç§¯åˆ†è®°å½•è¡¨';
```

**å­—æ®µè¯´æ˜**:
- `change_type`: å˜åŠ¨ç±»å‹(earn:è·å¾—, consume:æ¶ˆè€—, expire:è¿‡æœŸ, freeze:å†»ç»“, unfreeze:è§£å†»)
- `source_type`: æ¥æºç±»å‹(register:æ³¨å†Œ, checkin:ç­¾åˆ°, task:ä»»åŠ¡, purchase:è´­ä¹°, redeem:å…‘æ¢, invite:é‚€è¯·, manual:æ‰‹åŠ¨è°ƒæ•´, system:ç³»ç»Ÿæ“ä½œ)
- `expire_at`: è¿‡æœŸæ—¶é—´(ä»…change_type='earn'æ—¶æœ‰å€¼)
- `is_expired`: æ˜¯å¦å·²è¿‡æœŸ(å®šæ—¶ä»»åŠ¡æ ‡è®°)

---

#### 4.1.3 ç§¯åˆ†æ¶ˆè´¹å…³è”è¡¨(points_consumptions)

**ç”¨é€”**: è®°å½•ç§¯åˆ†æ¶ˆè´¹æ—¶å…·ä½“ä»å“ªäº›earnè®°å½•æ‰£å‡çš„ç§¯åˆ†,å®ç°FIFOæ¶ˆè´¹é€»è¾‘

```sql
CREATE TABLE `points_consumptions` (
  `id` VARCHAR(50) NOT NULL COMMENT 'è®°å½•ID',
  `user_id` VARCHAR(50) NOT NULL COMMENT 'ç”¨æˆ·ID',
  `earn_record_id` VARCHAR(50) NOT NULL COMMENT 'è·å¾—ç§¯åˆ†è®°å½•ID',
  `consumed_amount` INT NOT NULL COMMENT 'æ¶ˆè´¹æ•°é‡',
  `consume_type` VARCHAR(50) NOT NULL COMMENT 'æ¶ˆè´¹ç±»å‹:redeem,mall',
  `consume_description` VARCHAR(200) NOT NULL COMMENT 'æ¶ˆè´¹æè¿°',
  `related_id` VARCHAR(50) DEFAULT NULL COMMENT 'å…³è”ID',
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  PRIMARY KEY (`id`),
  INDEX `idx_user_id` (`user_id`),
  INDEX `idx_earn_record_id` (`earn_record_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç§¯åˆ†æ¶ˆè´¹å…³è”è¡¨';
```

---

#### 4.1.4 ç­¾åˆ°è®°å½•è¡¨(checkin_records)

```sql
CREATE TABLE `checkin_records` (
  `id` VARCHAR(50) NOT NULL COMMENT 'è®°å½•ID',
  `user_id` VARCHAR(50) NOT NULL COMMENT 'ç”¨æˆ·ID',
  `checkin_date` DATE NOT NULL COMMENT 'ç­¾åˆ°æ—¥æœŸ',
  `consecutive_days` INT NOT NULL DEFAULT 1 COMMENT 'è¿ç»­ç­¾åˆ°å¤©æ•°',
  `points_earned` INT NOT NULL COMMENT 'æœ¬æ¬¡è·å¾—ç§¯åˆ†',
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  PRIMARY KEY (`id`),
  UNIQUE KEY `uk_user_checkin_date` (`user_id`, `checkin_date`),
  INDEX `idx_user_id` (`user_id`),
  INDEX `idx_checkin_date` (`checkin_date`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç­¾åˆ°è®°å½•è¡¨';
```

**å”¯ä¸€çº¦æŸ**: `uk_user_checkin_date` é˜²æ­¢åŒä¸€å¤©é‡å¤ç­¾åˆ°

---

#### 4.1.5 ä»»åŠ¡å®Œæˆè®°å½•è¡¨(task_completions)

```sql
CREATE TABLE `task_completions` (
  `id` VARCHAR(50) NOT NULL COMMENT 'è®°å½•ID',
  `user_id` VARCHAR(50) NOT NULL COMMENT 'ç”¨æˆ·ID',
  `task_type` VARCHAR(50) NOT NULL COMMENT 'ä»»åŠ¡ç±»å‹:profile_complete,first_use,share,invite,purchase,review',
  `task_description` VARCHAR(200) NOT NULL COMMENT 'ä»»åŠ¡æè¿°',
  `points_earned` INT NOT NULL COMMENT 'è·å¾—ç§¯åˆ†',
  `related_id` VARCHAR(50) DEFAULT NULL COMMENT 'å…³è”ID(é‚€è¯·çš„ç”¨æˆ·IDç­‰)',
  `completed_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'å®Œæˆæ—¶é—´',
  PRIMARY KEY (`id`),
  INDEX `idx_user_id` (`user_id`),
  INDEX `idx_task_type` (`task_type`),
  INDEX `idx_completed_at` (`completed_at`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ä»»åŠ¡å®Œæˆè®°å½•è¡¨';
```

**æ³¨æ„**: ä¸€æ¬¡æ€§ä»»åŠ¡éœ€åœ¨åº”ç”¨å±‚æ£€æŸ¥å”¯ä¸€æ€§,å¯é‡å¤ä»»åŠ¡éœ€æ£€æŸ¥æ¯æ—¥/æ¯æœˆé™åˆ¶

---

#### 4.1.6 ç§¯åˆ†å•†åŸå•†å“è¡¨(points_mall_items)

```sql
CREATE TABLE `points_mall_items` (
  `id` VARCHAR(50) NOT NULL COMMENT 'å•†å“ID',
  `item_type` ENUM('coupon', 'membership', 'privilege', 'quota') NOT NULL COMMENT 'å•†å“ç±»å‹',
  `item_name` VARCHAR(100) NOT NULL COMMENT 'å•†å“åç§°',
  `item_description` TEXT COMMENT 'å•†å“æè¿°',
  `points_required` INT NOT NULL COMMENT 'æ‰€éœ€ç§¯åˆ†',
  `item_value` INT NOT NULL COMMENT 'å•†å“ä»·å€¼(ä¼˜æƒ åˆ¸é¢é¢/ä¼šå‘˜å¤©æ•°ç­‰)',
  `stock` INT NOT NULL DEFAULT -1 COMMENT 'åº“å­˜(-1è¡¨ç¤ºä¸é™)',
  `monthly_limit` INT DEFAULT NULL COMMENT 'æ¯æœˆå…‘æ¢æ¬¡æ•°é™åˆ¶(nullè¡¨ç¤ºä¸é™)',
  `status` ENUM('active', 'soldout', 'inactive') NOT NULL DEFAULT 'active' COMMENT 'çŠ¶æ€',
  `image_url` VARCHAR(500) DEFAULT NULL COMMENT 'å•†å“å›¾ç‰‡',
  `sort_order` INT NOT NULL DEFAULT 0 COMMENT 'æ’åº',
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  `updated_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT 'æ›´æ–°æ—¶é—´',
  PRIMARY KEY (`id`),
  INDEX `idx_status` (`status`),
  INDEX `idx_sort_order` (`sort_order`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç§¯åˆ†å•†åŸå•†å“è¡¨';
```

---

#### 4.1.7 ç§¯åˆ†å…‘æ¢è®°å½•è¡¨(points_redemptions)

```sql
CREATE TABLE `points_redemptions` (
  `id` VARCHAR(50) NOT NULL COMMENT 'å…‘æ¢è®°å½•ID',
  `user_id` VARCHAR(50) NOT NULL COMMENT 'ç”¨æˆ·ID',
  `item_id` VARCHAR(50) DEFAULT NULL COMMENT 'å•†å“ID(å•†åŸå…‘æ¢æ—¶æœ‰å€¼)',
  `item_type` VARCHAR(50) NOT NULL COMMENT 'å•†å“ç±»å‹:quota,coupon,membership,privilege',
  `item_name` VARCHAR(100) NOT NULL COMMENT 'å•†å“åç§°',
  `points_cost` INT NOT NULL COMMENT 'æ¶ˆè€—ç§¯åˆ†',
  `item_value` INT NOT NULL COMMENT 'å•†å“ä»·å€¼',
  `status` ENUM('completed', 'pending', 'failed') NOT NULL DEFAULT 'completed' COMMENT 'çŠ¶æ€',
  `coupon_code` VARCHAR(50) DEFAULT NULL COMMENT 'ä¼˜æƒ åˆ¸ç (å¦‚æœæ˜¯ä¼˜æƒ åˆ¸)',
  `expire_at` DATETIME DEFAULT NULL COMMENT 'è¿‡æœŸæ—¶é—´(ä¼˜æƒ åˆ¸/ç‰¹æƒ)',
  `created_at` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT 'åˆ›å»ºæ—¶é—´',
  PRIMARY KEY (`id`),
  INDEX `idx_user_id` (`user_id`),
  INDEX `idx_item_type` (`item_type`),
  INDEX `idx_created_at` (`created_at`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ç§¯åˆ†å…‘æ¢è®°å½•è¡¨';
```

---

### 4.2 åˆå§‹åŒ–æ•°æ®

#### 4.2.1 ç§¯åˆ†å•†åŸå•†å“åˆå§‹åŒ–

```sql
INSERT INTO `points_mall_items` (`id`, `item_type`, `item_name`, `item_description`, `points_required`, `item_value`, `stock`, `monthly_limit`, `status`, `sort_order`) VALUES
('item_coupon_50', 'coupon', '50å…ƒä¼˜æƒ åˆ¸', 'é€‚ç”¨äºæ‰€æœ‰å¥—é¤,æœ‰æ•ˆæœŸ30å¤©', 500, 50, -1, 2, 'active', 1),
('item_coupon_100', 'coupon', '100å…ƒä¼˜æƒ åˆ¸', 'é€‚ç”¨äºæ‰€æœ‰å¥—é¤,æœ‰æ•ˆæœŸ30å¤©', 900, 100, -1, 1, 'active', 2),
('item_membership_1m', 'membership', '1ä¸ªæœˆä¼šå‘˜', 'é«˜çº§ä¼šå‘˜æƒç›Š,ä»·å€¼99å…ƒ', 2000, 30, -1, NULL, 'active', 3),
('item_membership_3m', 'membership', '3ä¸ªæœˆä¼šå‘˜', 'é«˜çº§ä¼šå‘˜æƒç›Š,ä»·å€¼237å…ƒ', 5000, 90, -1, NULL, 'active', 4),
('item_privilege_priority', 'privilege', 'é«˜ä¼˜å…ˆçº§å¤„ç†ç‰¹æƒ(7å¤©)', 'ä»»åŠ¡ä¼˜å…ˆå¤„ç†,æœ‰æ•ˆæœŸ7å¤©', 800, 7, -1, NULL, 'active', 5),
('item_privilege_support', 'privilege', 'ä¸“å±å®¢æœé€šé“(30å¤©)', '1v1ä¸“å±å®¢æœ,æœ‰æ•ˆæœŸ30å¤©', 1500, 30, -1, NULL, 'active', 6);
```

---

## 5. APIæ¥å£è®¾è®¡

### 5.1 ç”¨æˆ·ç«¯æ¥å£

#### 5.1.1 æŸ¥è¯¢ç§¯åˆ†è´¦æˆ·

**æ¥å£**: `GET /api/points/account`

**è¯·æ±‚å¤´**:
```
Authorization: Bearer <token>
```

**å“åº”**:
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "user_id": "user_abc123",
    "total_points": 1500,
    "available_points": 850,
    "frozen_points": 0,
    "used_points": 500,
    "expired_points": 150,
    "created_at": "2025-10-01 10:00:00",
    "updated_at": "2025-10-30 15:30:00"
  }
}
```

---

#### 5.1.2 æ¯æ—¥ç­¾åˆ°

**æ¥å£**: `POST /api/points/checkin`

**è¯·æ±‚å¤´**:
```
Authorization: Bearer <token>
```

**å“åº”**:
```json
{
  "code": 0,
  "message": "ç­¾åˆ°æˆåŠŸ",
  "data": {
    "consecutive_days": 3,
    "points_earned": 6,
    "available_points": 856
  }
}
```

**é”™è¯¯å“åº”**:
```json
{
  "code": 40001,
  "message": "ä»Šå¤©å·²ç­¾åˆ°è¿‡äº†"
}
```

---

#### 5.1.3 å®Œæˆä»»åŠ¡

**æ¥å£**: `POST /api/points/tasks/complete`

**è¯·æ±‚å¤´**:
```
Authorization: Bearer <token>
```

**è¯·æ±‚ä½“**:
```json
{
  "task_type": "profile_complete",
  "related_id": null
}
```

**å“åº”**:
```json
{
  "code": 0,
  "message": "ä»»åŠ¡å®Œæˆ",
  "data": {
    "task_type": "profile_complete",
    "points_earned": 20,
    "available_points": 870
  }
}
```

---

#### 5.1.4 å…‘æ¢é…é¢

**æ¥å£**: `POST /api/points/redeem/quota`

**è¯·æ±‚å¤´**:
```
Authorization: Bearer <token>
```

**è¯·æ±‚ä½“**:
```json
{
  "quota_count": 8
}
```

**å“åº”**:
```json
{
  "code": 0,
  "message": "å…‘æ¢æˆåŠŸ",
  "data": {
    "quota_count": 8,
    "points_cost": 800,
    "available_points": 50,
    "quota_balance": 108
  }
}
```

---

#### 5.1.5 æŸ¥è¯¢ç§¯åˆ†æ˜ç»†

**æ¥å£**: `GET /api/points/records`

**è¯·æ±‚å¤´**:
```
Authorization: Bearer <token>
```

**æŸ¥è¯¢å‚æ•°**:
- `change_type`: å˜åŠ¨ç±»å‹(å¯é€‰: earn,consume,expire)
- `page`: é¡µç (é»˜è®¤1)
- `page_size`: æ¯é¡µæ•°é‡(é»˜è®¤20)

**å“åº”**:
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "records": [
      {
        "id": "points_rec_xyz789",
        "change_type": "earn",
        "change_amount": 6,
        "source_type": "checkin",
        "source_description": "è¿ç»­ç­¾åˆ°ç¬¬3å¤©",
        "balance_after": 856,
        "expire_at": "2026-10-30",
        "created_at": "2025-10-30 08:00:00"
      },
      {
        "id": "points_rec_abc456",
        "change_type": "consume",
        "change_amount": -800,
        "source_type": "redeem",
        "source_description": "å…‘æ¢8ä¸ªå¤„ç†é…é¢",
        "balance_after": 50,
        "expire_at": null,
        "created_at": "2025-10-30 10:00:00"
      }
    ],
    "pagination": {
      "page": 1,
      "page_size": 20,
      "total": 45
    }
  }
}
```

---

#### 5.1.6 æŸ¥è¯¢å•†åŸå•†å“åˆ—è¡¨

**æ¥å£**: `GET /api/points/mall/items`

**æŸ¥è¯¢å‚æ•°**:
- `item_type`: å•†å“ç±»å‹(å¯é€‰: coupon,membership,privilege)

**å“åº”**:
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "items": [
      {
        "id": "item_coupon_50",
        "item_type": "coupon",
        "item_name": "50å…ƒä¼˜æƒ åˆ¸",
        "item_description": "é€‚ç”¨äºæ‰€æœ‰å¥—é¤,æœ‰æ•ˆæœŸ30å¤©",
        "points_required": 500,
        "item_value": 50,
        "stock": -1,
        "monthly_limit": 2,
        "status": "active",
        "image_url": "https://..."
      }
    ]
  }
}
```

---

#### 5.1.7 å…‘æ¢å•†åŸå•†å“

**æ¥å£**: `POST /api/points/mall/redeem`

**è¯·æ±‚å¤´**:
```
Authorization: Bearer <token>
```

**è¯·æ±‚ä½“**:
```json
{
  "item_id": "item_coupon_50"
}
```

**å“åº”**:
```json
{
  "code": 0,
  "message": "å…‘æ¢æˆåŠŸ",
  "data": {
    "redemption_id": "redemption_xyz789",
    "item_name": "50å…ƒä¼˜æƒ åˆ¸",
    "points_cost": 500,
    "coupon_code": "COUP-ABC12345",
    "expire_at": "2025-11-30 23:59:59"
  }
}
```

---

### 5.2 ç®¡ç†å‘˜ç«¯æ¥å£

#### 5.2.1 æŸ¥è¯¢ç§¯åˆ†ç»Ÿè®¡æ•°æ®

**æ¥å£**: `GET /api/admin/points/statistics`

**è¯·æ±‚å¤´**:
```
Authorization: Bearer <admin_token>
```

**å“åº”**:
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "total_points_granted": 1250000,
    "total_points_consumed": 850000,
    "total_points_expired": 50000,
    "checkin_count": 8500,
    "quota_redeem_count": 2150,
    "membership_redeem_count": 320,
    "points_trend": [
      { "date": "2025-10-01", "granted": 35000, "consumed": 25000 },
      { "date": "2025-10-02", "granted": 38000, "consumed": 28000 }
    ]
  }
}
```

---

#### 5.2.2 æŸ¥è¯¢ç”¨æˆ·ç§¯åˆ†åˆ—è¡¨

**æ¥å£**: `GET /api/admin/points/users`

**æŸ¥è¯¢å‚æ•°**:
- `search`: æœç´¢å…³é”®è¯(ç”¨æˆ·ID/æ‰‹æœºå·)
- `page`: é¡µç 
- `page_size`: æ¯é¡µæ•°é‡

**å“åº”**:
```json
{
  "code": 0,
  "message": "success",
  "data": {
    "users": [
      {
        "user_id": "user_abc123",
        "phone": "138****8888",
        "available_points": 850,
        "total_points": 1500,
        "used_points": 500
      }
    ],
    "pagination": {
      "page": 1,
      "page_size": 20,
      "total": 1250
    }
  }
}
```

---

#### 5.2.3 æ‰‹åŠ¨è°ƒæ•´ç”¨æˆ·ç§¯åˆ†

**æ¥å£**: `POST /api/admin/points/adjust`

**è¯·æ±‚ä½“**:
```json
{
  "user_id": "user_abc123",
  "change_amount": 100,
  "reason": "è¡¥å¿ç”¨æˆ·"
}
```

**å“åº”**:
```json
{
  "code": 0,
  "message": "è°ƒæ•´æˆåŠŸ",
  "data": {
    "user_id": "user_abc123",
    "change_amount": 100,
    "available_points": 950
  }
}
```

---

#### 5.2.4 å†»ç»“/è§£å†»ç”¨æˆ·ç§¯åˆ†

**æ¥å£**: `POST /api/admin/points/freeze` (å†»ç»“)
**æ¥å£**: `POST /api/admin/points/unfreeze` (è§£å†»)

**è¯·æ±‚ä½“**:
```json
{
  "user_id": "user_abc123",
  "amount": 500,
  "reason": "å¼‚å¸¸è¡Œä¸º"
}
```

**å“åº”**:
```json
{
  "code": 0,
  "message": "å†»ç»“æˆåŠŸ",
  "data": {
    "user_id": "user_abc123",
    "frozen_points": 500,
    "available_points": 350
  }
}
```

---

#### 5.2.5 ç®¡ç†å•†åŸå•†å“

**æ–°å¢å•†å“**: `POST /api/admin/points/mall/items`
**ç¼–è¾‘å•†å“**: `PUT /api/admin/points/mall/items/:id`
**åˆ é™¤å•†å“**: `DELETE /api/admin/points/mall/items/:id`

---

## 6. æŠ€æœ¯å®ç°è¦ç‚¹

### 6.1 ç§¯åˆ†å‘æ”¾å…¬å…±å‡½æ•°

```javascript
/**
 * å‘æ”¾ç§¯åˆ†(å…¬å…±å‡½æ•°)
 * @param {Object} trx - æ•°æ®åº“äº‹åŠ¡å¯¹è±¡
 * @param {string} userId - ç”¨æˆ·ID
 * @param {number} amount - ç§¯åˆ†æ•°é‡
 * @param {string} sourceType - æ¥æºç±»å‹
 * @param {string} description - æè¿°
 * @param {string} relatedId - å…³è”ID
 */
async function grantPoints(trx, userId, amount, sourceType, description, relatedId = null) {
  // 1. æŸ¥è¯¢ç§¯åˆ†è´¦æˆ·
  let account = await trx('points_accounts').where({ user_id: userId }).first();

  // å¦‚æœè´¦æˆ·ä¸å­˜åœ¨,åˆ›å»ºæ–°è´¦æˆ·
  if (!account) {
    await trx('points_accounts').insert({
      user_id: userId,
      total_points: 0,
      available_points: 0,
      frozen_points: 0,
      used_points: 0,
      expired_points: 0
    });
    account = { total_points: 0, available_points: 0 };
  }

  // 2. æ›´æ–°ç§¯åˆ†è´¦æˆ·
  await trx('points_accounts')
    .where({ user_id: userId })
    .increment('total_points', amount)
    .increment('available_points', amount);

  // 3. åˆ›å»ºç§¯åˆ†è®°å½•
  await trx('points_records').insert({
    id: `points_rec_${uuidv4()}`,
    user_id: userId,
    change_type: 'earn',
    change_amount: amount,
    source_type: sourceType,
    source_description: description,
    related_id: relatedId,
    balance_before: account.available_points,
    balance_after: account.available_points + amount,
    expire_at: moment().add(365, 'days').format('YYYY-MM-DD'), // 365å¤©åè¿‡æœŸ
    is_expired: false
  });

  logger.info(`[PointsGrant] ç”¨æˆ·${userId}è·å¾—ç§¯åˆ†${amount},æ¥æº:${sourceType}`, { description, relatedId });
}
```

---

### 6.2 å®šæ—¶ä»»åŠ¡

#### 6.2.1 ç§¯åˆ†è¿‡æœŸæ¸…ç†ä»»åŠ¡

**æ‰§è¡Œé¢‘ç‡**: æ¯å¤©å‡Œæ™¨3ç‚¹

**ä»»åŠ¡ä»£ç **: è§ä¸Šæ–‡"2.4.2 è¿‡æœŸå¤„ç†æµç¨‹"

---

#### 6.2.2 ä½£é‡‘è§£å†»ä»»åŠ¡(ä¸åˆ†é”€ç³»ç»Ÿå¯¹æ¥)

**æ‰§è¡Œé¢‘ç‡**: æ¯å°æ—¶ä¸€æ¬¡

**ä»»åŠ¡å†…å®¹**: æ£€æŸ¥åˆ†é”€ç³»ç»Ÿä¸­å·²è¿‡å†»ç»“æœŸçš„ä½£é‡‘,è§£å†»å¹¶å‘æ”¾ç§¯åˆ†

---

### 6.3 æ€§èƒ½ä¼˜åŒ–

#### 6.3.1 æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–

- `points_accounts.available_points`: æŸ¥è¯¢å¯ç”¨ç§¯åˆ†æ’è¡Œ
- `points_records.user_id`: æŸ¥è¯¢ç”¨æˆ·ç§¯åˆ†æ˜ç»†
- `points_records.expire_at, is_expired`: è¿‡æœŸç§¯åˆ†æ‰«æ
- `checkin_records.user_id, checkin_date`: ç­¾åˆ°è®°å½•å”¯ä¸€çº¦æŸ
- `task_completions.user_id, task_type, completed_at`: ä»»åŠ¡å®Œæˆæ¬¡æ•°æŸ¥è¯¢

---

#### 6.3.2 ç¼“å­˜ç­–ç•¥

**Redisç¼“å­˜**:
- ç”¨æˆ·ç§¯åˆ†è´¦æˆ·: `points:account:{user_id}`, TTL 5åˆ†é’Ÿ
- å•†åŸå•†å“åˆ—è¡¨: `points:mall:items`, TTL 10åˆ†é’Ÿ
- ç”¨æˆ·ä»Šæ—¥ç­¾åˆ°çŠ¶æ€: `points:checkin:{user_id}:{date}`, TTL 24å°æ—¶
- ç”¨æˆ·ä»»åŠ¡å®Œæˆæ¬¡æ•°: `points:task:{user_id}:{task_type}:{date/month}`, TTL 24å°æ—¶

**ç¼“å­˜å¤±æ•ˆç­–ç•¥**:
- ç§¯åˆ†å˜åŠ¨åç«‹å³åˆ é™¤è´¦æˆ·ç¼“å­˜
- å•†å“ä¸Šä¸‹æ¶ååˆ é™¤å•†å“åˆ—è¡¨ç¼“å­˜

---

## 7. é£é™©æ§åˆ¶

### 7.1 è´¢åŠ¡å®‰å…¨é£é™©

**é£é™©ç‚¹**:
1. å¹¶å‘å…‘æ¢å¯¼è‡´ç§¯åˆ†è¶…æ‰£
2. ç§¯åˆ†è¿‡æœŸæœªæ¸…ç†å¯¼è‡´æ•°æ®ä¸ä¸€è‡´
3. é‡å¤å®Œæˆä»»åŠ¡åˆ·ç§¯åˆ†
4. æ¶æ„é€€æ¬¾åä»æŒæœ‰ç§¯åˆ†

**æ§åˆ¶æªæ–½**:
1. ä½¿ç”¨è¡Œé”(`forUpdate()`)é˜²æ­¢å¹¶å‘è¶…æ‰£
2. å®šæ—¶ä»»åŠ¡å®šæœŸæ‰«æè¿‡æœŸç§¯åˆ†
3. å”¯ä¸€çº¦æŸ+åº”ç”¨å±‚æ ¡éªŒé˜²æ­¢é‡å¤å®Œæˆ
4. é€€æ¬¾æ—¶æ‰£é™¤å·²å‘æ”¾çš„ç§¯åˆ†

---

### 7.2 å¼‚å¸¸è¡Œä¸ºç›‘æ§

**ç›‘æ§æŒ‡æ ‡**:
- çŸ­æ—¶é—´å†…å¤§é‡ç§¯åˆ†è·å–(1å°æ—¶å†…>500ç§¯åˆ†)
- çŸ­æ—¶é—´å†…å¤§é‡ç§¯åˆ†æ¶ˆè´¹(5åˆ†é’Ÿå†…>5000ç§¯åˆ†)
- åŒä¸€IP/è®¾å¤‡å¤šè´¦å·ç­¾åˆ°
- è‡ªæ¨è‡ªä¹°(é‚€è¯·è‡ªå·±æ³¨å†Œçš„å°å·)

**å¤„ç†æªæ–½**:
- è‡ªåŠ¨å†»ç»“å¼‚å¸¸è´¦æˆ·çš„ç§¯åˆ†
- å‘é€å‘Šè­¦é€šçŸ¥ç®¡ç†å‘˜
- äººå·¥å®¡æ ¸åå†³å®šæ˜¯å¦è§£å†»

---

## 8. ä¸Šçº¿è®¡åˆ’

### 8.1 å¼€å‘æ’æœŸ

| é˜¶æ®µ | ä»»åŠ¡ | è´Ÿè´£äºº | å·¥æœŸ |
|------|------|--------|------|
| æ•°æ®åº“è®¾è®¡ | åˆ›å»º7å¼ è¡¨+ç´¢å¼• | database_migration_skill | 1å¤© |
| åç«¯å¼€å‘ | 20ä¸ªAPIæ¥å£+å®šæ—¶ä»»åŠ¡ | backend_dev_skill | 5å¤© |
| å‰ç«¯å¼€å‘(ç”¨æˆ·ç«¯) | 4ä¸ªé¡µé¢ | frontend_dev_skill | 4å¤© |
| å‰ç«¯å¼€å‘(ç®¡ç†ç«¯) | 4ä¸ªé¡µé¢ | admin_frontend_dev_skill | 3å¤© |
| è´¢åŠ¡å®‰å…¨å®¡æŸ¥ | å®¡æŸ¥è´¢åŠ¡é€»è¾‘ | billing_guard_skill | 1å¤© |
| QAæµ‹è¯• | åŠŸèƒ½æµ‹è¯•+å®‰å…¨æµ‹è¯• | qa_acceptance_skill | 2å¤© |
| ä»£ç å®¡æŸ¥ | ä»£ç è´¨é‡å®¡æŸ¥ | reviewer_skill | 1å¤© |
| **æ€»è®¡** | | | **17å¤©** |

---

### 8.2 ç°åº¦å‘å¸ƒè®¡åˆ’

**ç¬¬ä¸€é˜¶æ®µ(10%ç”¨æˆ·)**:
- å¼€æ”¾æ¯æ—¥ç­¾åˆ°åŠŸèƒ½
- å¼€æ”¾ç§¯åˆ†å…‘æ¢é…é¢åŠŸèƒ½
- ç›‘æ§ç§¯åˆ†å‘æ”¾å’Œæ¶ˆè´¹æ•°æ®

**ç¬¬äºŒé˜¶æ®µ(50%ç”¨æˆ·)**:
- å¼€æ”¾ä»»åŠ¡ç³»ç»Ÿ
- å¼€æ”¾ç§¯åˆ†å•†åŸ(ä¼˜æƒ åˆ¸+ä¼šå‘˜)
- æ”¶é›†ç”¨æˆ·åé¦ˆ,ä¼˜åŒ–å…‘æ¢æ¯”ä¾‹

**ç¬¬ä¸‰é˜¶æ®µ(100%ç”¨æˆ·)**:
- å…¨é‡å¼€æ”¾æ‰€æœ‰åŠŸèƒ½
- ç›‘æ§æ ¸å¿ƒæŒ‡æ ‡(DAU, ç•™å­˜ç‡, è½¬åŒ–ç‡)

---

## 9. æˆåŠŸæŒ‡æ ‡

### 9.1 æ ¸å¿ƒæŒ‡æ ‡

| æŒ‡æ ‡ | å½“å‰ | ç›®æ ‡ | ç»Ÿè®¡å‘¨æœŸ |
|------|------|------|---------|
| ç”¨æˆ·æ—¥æ´»è·ƒåº¦(DAU) | 5,000 | 6,500 (+30%) | ä¸Šçº¿å30å¤© |
| ç”¨æˆ·7æ—¥ç•™å­˜ç‡ | 35% | 42% (+20%) | ä¸Šçº¿å30å¤© |
| ç§¯åˆ†å…‘æ¢é…é¢ä½¿ç”¨ç‡ | - | 40% | ä¸Šçº¿å30å¤© |
| ç§¯åˆ†å…‘æ¢ä¼šå‘˜è½¬åŒ–ç‡ | - | 15% | ä¸Šçº¿å30å¤© |
| æ¯æ—¥ç­¾åˆ°å‚ä¸ç‡ | - | 60% | ä¸Šçº¿å30å¤© |

---

### 9.2 æ•°æ®ç›‘æ§å¤§ç›˜

**æ¯æ—¥ç›‘æ§æŒ‡æ ‡**:
- ç§¯åˆ†å‘æ”¾æ€»é‡(æŒ‰æ¥æºç±»å‹ç»Ÿè®¡)
- ç§¯åˆ†æ¶ˆè´¹æ€»é‡(æŒ‰å…‘æ¢ç±»å‹ç»Ÿè®¡)
- ç­¾åˆ°å‚ä¸äººæ•°å’Œå‚ä¸ç‡
- ä»»åŠ¡å®Œæˆäººæ¬¡(æŒ‰ä»»åŠ¡ç±»å‹ç»Ÿè®¡)
- å…‘æ¢é…é¢äººæ•°å’Œé…é¢æ€»é‡
- å…‘æ¢ä¼šå‘˜äººæ•°å’Œè½¬åŒ–ç‡

**å‘Šè­¦é˜ˆå€¼**:
- ç§¯åˆ†å‘æ”¾å¼‚å¸¸å¢é•¿(æ—¥å¢é•¿>50%)
- ç§¯åˆ†æ¶ˆè´¹å¼‚å¸¸å¢é•¿(æ—¥å¢é•¿>50%)
- å•ç”¨æˆ·ç§¯åˆ†è·å–å¼‚å¸¸(1å°æ—¶å†…>500ç§¯åˆ†)

---

## 10. FAQ

### 10.1 ç”¨æˆ·å¸¸è§é—®é¢˜

**Q: ç§¯åˆ†æœ‰æ•ˆæœŸæ˜¯å¤šä¹…?**
A: æ‰€æœ‰ç§¯åˆ†è·å¾—åæœ‰æ•ˆæœŸä¸º365å¤©,è¿‡æœŸåè‡ªåŠ¨æ¸…é›¶ã€‚

**Q: ç§¯åˆ†å…‘æ¢é…é¢çš„æ¯”ä¾‹æ˜¯å¤šå°‘?**
A: 100ç§¯åˆ† = 1ä¸ªå¤„ç†é…é¢,æœ€ä½å…‘æ¢100ç§¯åˆ†ã€‚

**Q: ç­¾åˆ°ä¸­æ–­åç§¯åˆ†å¥–åŠ±ä¼šæ¸…é›¶å—?**
A: è¿ç»­ç­¾åˆ°å¤©æ•°ä¼šæ¸…é›¶,é‡æ–°ä»ç¬¬1å¤©å¼€å§‹,ä½†å·²è·å¾—çš„ç§¯åˆ†ä¸ä¼šæ¸…é›¶ã€‚

**Q: è´­ä¹°ä¼šå‘˜åé€€æ¬¾,ç§¯åˆ†ä¼šè¢«æ‰£é™¤å—?**
A: æ˜¯çš„,é€€æ¬¾æ—¶ä¼šæ‰£é™¤è´­ä¹°æ—¶èµ é€çš„ç§¯åˆ†ã€‚å¦‚æœç§¯åˆ†å·²ä½¿ç”¨,å¯èƒ½å¯¼è‡´è´¦æˆ·ç§¯åˆ†ä¸è¶³,éœ€è”ç³»å®¢æœå¤„ç†ã€‚

**Q: ç§¯åˆ†å¯ä»¥è½¬èµ ç»™å…¶ä»–ç”¨æˆ·å—?**
A: ä¸å¯ä»¥,ç§¯åˆ†ä»…é™æœ¬äººä½¿ç”¨,æ— æ³•è½¬èµ ã€‚

**Q: å…‘æ¢çš„ä¼˜æƒ åˆ¸æœ‰æ•ˆæœŸæ˜¯å¤šä¹…?**
A: å…‘æ¢åçš„ä¼˜æƒ åˆ¸æœ‰æ•ˆæœŸä¸º30å¤©,è¯·åŠæ—¶ä½¿ç”¨ã€‚

---

### 10.2 æŠ€æœ¯é—®é¢˜

**Q: å¦‚ä½•ä¿è¯ç§¯åˆ†å…‘æ¢çš„å¹¶å‘å®‰å…¨æ€§?**
A: ä½¿ç”¨æ•°æ®åº“è¡Œé”(`forUpdate()`)+ äº‹åŠ¡å¤„ç†ä¿è¯å¹¶å‘å®‰å…¨ã€‚

**Q: å¦‚ä½•å®ç°FIFOç§¯åˆ†æ¶ˆè´¹?**
A: é€šè¿‡`points_consumptions`å…³è”è¡¨è®°å½•ç§¯åˆ†æ¶ˆè´¹æ¥æº,æ¶ˆè´¹æ—¶æŒ‰`expire_at`å‡åºæŸ¥è¯¢å¹¶æ‰£å‡ã€‚

**Q: ç§¯åˆ†è¿‡æœŸå¦‚ä½•å¤„ç†?**
A: å®šæ—¶ä»»åŠ¡æ¯å¤©å‡Œæ™¨3ç‚¹æ‰«æ`expire_at < ä»Šå¤©`çš„è®°å½•,æ ‡è®°ä¸ºå·²è¿‡æœŸå¹¶æ›´æ–°è´¦æˆ·ã€‚

**Q: å¦‚ä½•é˜²æ­¢åˆ·ç§¯åˆ†?**
A: æ•°æ®åº“å”¯ä¸€çº¦æŸ+åº”ç”¨å±‚æ ¡éªŒ+å¼‚å¸¸è¡Œä¸ºç›‘æ§+ç§¯åˆ†å†»ç»“æœºåˆ¶ã€‚

---

## 11. é™„å½•

### 11.1 æœ¯è¯­è¡¨

| æœ¯è¯­ | è¯´æ˜ |
|------|------|
| å¯ç”¨ç§¯åˆ† | å½“å‰å¯ä»¥ä½¿ç”¨çš„ç§¯åˆ†ä½™é¢ |
| å†»ç»“ç§¯åˆ† | å› å¼‚å¸¸è¡Œä¸ºè¢«å†»ç»“çš„ç§¯åˆ†,æ— æ³•ä½¿ç”¨ |
| å·²ä½¿ç”¨ç§¯åˆ† | å·²é€šè¿‡å…‘æ¢æ¶ˆè€—çš„ç§¯åˆ† |
| å·²è¿‡æœŸç§¯åˆ† | è¶…è¿‡æœ‰æ•ˆæœŸè¢«æ¸…é›¶çš„ç§¯åˆ† |
| FIFOæ¶ˆè´¹ | First In First Out,ä¼˜å…ˆæ¶ˆè€—å³å°†è¿‡æœŸçš„ç§¯åˆ† |
| è¡Œé” | æ•°æ®åº“è¡Œçº§é”,é˜²æ­¢å¹¶å‘å†²çª |

---

### 11.2 å‚è€ƒèµ„æ–™

- [æ·˜å®ç§¯åˆ†ä½“ç³»è®¾è®¡](https://www.taobao.com)
- [äº¬ä¸œè±†è§„åˆ™è¯´æ˜](https://www.jd.com)
- [ç¾å›¾ç§€ç§€ç¾è±†ç³»ç»Ÿ](https://xiuxiu.meitu.com)
- [SaaSç§¯åˆ†ç³»ç»Ÿæœ€ä½³å®è·µ 2024](https://www.saas-industry-report.com)

---

**æ–‡æ¡£ç»“æŸ**
