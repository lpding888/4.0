# ğŸ”§ åŠ¨æ€é…ç½®ç³»ç»Ÿæ–‡æ¡£

## æ¦‚è¿°

ä¸ºäº†è§£å†³åŸé¡¹ç›®ä¸­APIå¯†é’¥å’Œæç¤ºè¯**ç¡¬ç¼–ç **çš„é—®é¢˜ï¼Œå®ç°äº†ä¸€ä¸ªå®Œæ•´çš„**åŠ¨æ€é…ç½®ç®¡ç†ç³»ç»Ÿ**ã€‚ç°åœ¨ç®¡ç†å‘˜å¯ä»¥ç›´æ¥åœ¨åå°ç®¡ç†é¡µé¢ä¸­ï¼š

- âœ… åŠ¨æ€ä¿®æ”¹APIå¯†é’¥ï¼ˆæ··å…ƒã€KUAIã€è…¾è®¯äº‘ç­‰ï¼‰
- âœ… è‡ªå®šä¹‰AIæç¤ºè¯æ¨¡æ¿
- âœ… é…ç½®ä¸šåŠ¡å‚æ•°ï¼ˆä»·æ ¼ã€é…é¢ç­‰ï¼‰
- âœ… ç³»ç»Ÿå¼€å…³å’Œå…¬å‘Šç®¡ç†

## æ ¸å¿ƒç‰¹æ€§

### 1. é…ç½®åˆ†ç±»ç®¡ç†
- **api**: APIå¯†é’¥é…ç½®ï¼ˆæ··å…ƒã€KUAIã€RunningHubç­‰ï¼‰
- **business**: ä¸šåŠ¡å‚æ•°ï¼ˆä»·æ ¼ã€é…é¢ç­‰ï¼‰
- **prompt**: æç¤ºè¯æ¨¡æ¿
- **system**: ç³»ç»Ÿé…ç½®ï¼ˆç»´æŠ¤æ¨¡å¼ã€å…¬å‘Šç­‰ï¼‰

### 2. å®‰å…¨ç‰¹æ€§
- **æ•æ„Ÿé…ç½®ä¿æŠ¤**: APIå¯†é’¥è‡ªåŠ¨è„±æ•æ˜¾ç¤º
- **æƒé™æ§åˆ¶**: æ•æ„Ÿé…ç½®éœ€è¦ç®¡ç†å‘˜æƒé™
- **é…ç½®å®¡è®¡**: è®°å½•åˆ›å»ºäººå’Œæ›´æ–°äºº
- **ç¼“å­˜æœºåˆ¶**: 5åˆ†é’Ÿç¼“å­˜ï¼Œæé«˜æ€§èƒ½

### 3. é…ç½®ç±»å‹æ”¯æŒ
- **string**: æ–‡æœ¬å­—ç¬¦ä¸²
- **number**: æ•°å­—
- **boolean**: å¸ƒå°”å€¼
- **json**: JSONå¯¹è±¡
- **secret**: æ•æ„Ÿä¿¡æ¯ï¼ˆè‡ªåŠ¨åŠ å¯†å­˜å‚¨ï¼‰

## APIæ¥å£

### è·å–é…ç½®åˆ—è¡¨
```http
GET /api/system-config?category=api&page=1&limit=50
Authorization: Bearer {token}
```

### è·å–å•ä¸ªé…ç½®
```http
GET /api/system-config/hunyuan_api_key
Authorization: Bearer {token}
```

### è®¾ç½®é…ç½®
```http
PUT /api/system-config/hunyuan_api_key
Authorization: Bearer {token}
Content-Type: application/json

{
  "value": "your_new_api_key_here",
  "type": "secret",
  "description": "æ··å…ƒå¤§æ¨¡å‹APIå¯†é’¥"
}
```

### æ‰¹é‡è®¾ç½®é…ç½®
```http
POST /api/system-config/batch
Authorization: Bearer {token}
Content-Type: application/json

{
  "configs": [
    {
      "key": "hunyuan_api_key",
      "value": "new_key",
      "type": "secret"
    },
    {
      "key": "plan_monthly_quota",
      "value": "150",
      "type": "number"
    }
  ]
}
```

### è·å–åˆ†ç±»é…ç½®
```http
GET /api/system-config/category/api?includeSecrets=false
Authorization: Bearer {token}
```

### å¯¼å‡ºé…ç½®
```http
GET /api/system-config/export?category=prompt&includeSecrets=false
Authorization: Bearer {token}
```

## é…ç½®é¡¹è¯´æ˜

### APIé…ç½®ç±»
| é…ç½®é”® | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `hunyuan_api_key` | secret | æ··å…ƒå¤§æ¨¡å‹APIå¯†é’¥ |
| `hunyuan_api_secret` | secret | æ··å…ƒå¤§æ¨¡å‹APIå¯†é’¥ |
| `kuai_api_key` | secret | KUAIå¿«å½±APIå¯†é’¥ |
| `runninghub_api_key` | secret | RunningHub APIå¯†é’¥ |
| `tencent_secret_id` | secret | è…¾è®¯äº‘SecretID |
| `tencent_secret_key` | secret | è…¾è®¯äº‘SecretKey |

### ä¸šåŠ¡é…ç½®ç±»
| é…ç½®é”® | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `plan_monthly_quota` | number | 100 | ä¼šå‘˜æœˆåº¦é…é¢ |
| `membership_price` | number | 9900 | ä¼šå‘˜ä»·æ ¼(åˆ†) |

### æç¤ºè¯é…ç½®ç±»
| é…ç½®é”® | ç±»å‹ | è¯´æ˜ |
|--------|------|------|
| `video_shooting_prompt_template` | json | è§†é¢‘æ‹æ‘„è„šæœ¬æ¨¡æ¿ |

### ç³»ç»Ÿé…ç½®ç±»
| é…ç½®é”® | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| `system_maintenance_mode` | boolean | false | ç³»ç»Ÿç»´æŠ¤æ¨¡å¼ |
| `system_notice` | string | "" | ç³»ç»Ÿå…¬å‘Š |

## åŠ¨æ€æç¤ºè¯æ¨¡æ¿

### æ¨¡æ¿æ ¼å¼
```json
{
  "template": "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„æœè£…è§†é¢‘æ‹æ‘„å¯¼æ¼”...\nå›¾ç‰‡URL: {{imageUrl}}\næœè£…ç±»å‹: {{clothingType}}",
  "variables": ["imageUrl", "clothingType", "requirements"]
}
```

### å˜é‡æ›¿æ¢
- `{{imageUrl}}`: æœè£…å›¾ç‰‡URL
- `{{clothingType}}`: æœè£…ç±»å‹
- `{{requirements}}`: æ‹æ‘„è¦æ±‚

### ä½¿ç”¨ç¤ºä¾‹
```javascript
// åœ¨æ··å…ƒæœåŠ¡ä¸­è‡ªåŠ¨ä½¿ç”¨åŠ¨æ€æ¨¡æ¿
const promptConfig = await systemConfigService.get('video_shooting_prompt_template');
if (promptConfig && promptConfig.template) {
  let prompt = promptConfig.template;
  prompt = prompt.replace(/{{imageUrl}}/g, imageUrl);
  prompt = prompt.replace(/{{clothingType}}/g, params.clothingType || 'æœªæŒ‡å®š');
  // ... ä½¿ç”¨åŠ¨æ€ç”Ÿæˆçš„æç¤ºè¯
}
```

## ç¬¬ä¸‰æ–¹æœåŠ¡é›†æˆ

### æ··å…ƒæœåŠ¡åŠ¨æ€é…ç½®
```javascript
// hunyuan.service.js ä¸­çš„å®ç°
async _initialize() {
  // ä¼˜å…ˆä»åŠ¨æ€é…ç½®è·å–ï¼Œå›é€€åˆ°ç¯å¢ƒå˜é‡
  this.apiKey = await systemConfigService.get('hunyuan_api_key', process.env.HUNYUAN_API_KEY);
  this.apiSecret = await systemConfigService.get('hunyuan_api_secret', process.env.HUNYUAN_API_SECRET);
  this.baseUrl = await systemConfigService.get('hunyuan_api_url', process.env.HUNYUAN_API_URL);
}
```

### å…¶ä»–æœåŠ¡é›†æˆ
åŒæ ·æ”¯æŒåŠ¨æ€é…ç½®çš„æœåŠ¡ï¼š
- KUAIå¿«å½±æœåŠ¡
- RunningHub AIæœåŠ¡
- è…¾è®¯äº‘COSæœåŠ¡
- çŸ­ä¿¡æœåŠ¡

## æ•°æ®åº“ç»“æ„

### system_configs è¡¨
```sql
CREATE TABLE system_configs (
  id INT AUTO_INCREMENT PRIMARY KEY,
  config_key VARCHAR(100) NOT NULL UNIQUE,
  config_value TEXT,
  config_type VARCHAR(20) NOT NULL DEFAULT 'string',
  category VARCHAR(50) NOT NULL DEFAULT 'general',
  description VARCHAR(500),
  is_secret BOOLEAN DEFAULT FALSE,
  is_system BOOLEAN DEFAULT FALSE,
  is_active BOOLEAN DEFAULT TRUE,
  sort_order INT DEFAULT 0,
  created_by INT UNSIGNED,
  updated_by INT UNSIGNED,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP
);
```

## ä½¿ç”¨æµç¨‹

### 1. é¦–æ¬¡é…ç½®
```bash
# è¿è¡Œè¿ç§»
npm run db:migrate

# è¿è¡Œç§å­æ•°æ®
npm run db:seed

# å¯åŠ¨æœåŠ¡
npm run dev
```

### 2. ç®¡ç†åå°é…ç½®
1. ç™»å½•ç®¡ç†åå°
2. è¿›å…¥"ç³»ç»Ÿé…ç½®"é¡µé¢
3. é€‰æ‹©é…ç½®åˆ†ç±»ï¼ˆAPIã€ä¸šåŠ¡ã€æç¤ºè¯ã€ç³»ç»Ÿï¼‰
4. ä¿®æ”¹é…ç½®å€¼
5. ä¿å­˜æ›´æ”¹

### 3. æœåŠ¡è‡ªåŠ¨ä½¿ç”¨æ–°é…ç½®
- æœåŠ¡ä¼šä¼˜å…ˆä½¿ç”¨åŠ¨æ€é…ç½®
- é…ç½®æœ‰5åˆ†é’Ÿç¼“å­˜ï¼Œè‡ªåŠ¨åˆ·æ–°
- æ— éœ€é‡å¯æœåŠ¡å³å¯ç”Ÿæ•ˆ

## å®‰å…¨æ³¨æ„äº‹é¡¹

1. **æ•æ„Ÿé…ç½®ä¿æŠ¤**: APIå¯†é’¥åœ¨å‰ç«¯æ˜¾ç¤ºä¸º`***å·²é…ç½®***`
2. **æƒé™æ§åˆ¶**: åªæœ‰ç®¡ç†å‘˜å¯ä»¥ä¿®æ”¹æ•æ„Ÿé…ç½®
3. **é…ç½®å®¡è®¡**: æ‰€æœ‰ä¿®æ”¹éƒ½ä¼šè®°å½•æ“ä½œäºº
4. **å›é€€æœºåˆ¶**: åŠ¨æ€é…ç½®è·å–å¤±è´¥æ—¶è‡ªåŠ¨å›é€€åˆ°ç¯å¢ƒå˜é‡

## æ€§èƒ½ä¼˜åŒ–

1. **é…ç½®ç¼“å­˜**: 5åˆ†é’Ÿå†…å­˜ç¼“å­˜ï¼Œå‡å°‘æ•°æ®åº“æŸ¥è¯¢
2. **åˆ†ç±»ç´¢å¼•**: æŒ‰åˆ†ç±»å’ŒçŠ¶æ€å»ºç«‹æ•°æ®åº“ç´¢å¼•
3. **æ‡’åŠ è½½**: æœåŠ¡é…ç½®æŒ‰éœ€åˆå§‹åŒ–
4. **æ‰¹é‡æ“ä½œ**: æ”¯æŒæ‰¹é‡è®¾ç½®å’Œå¯¼å…¥å¯¼å‡º

## æ‰©å±•æ€§

ç³»ç»Ÿè®¾è®¡æ”¯æŒè½»æ¾æ‰©å±•ï¼š
- æ–°å¢é…ç½®åˆ†ç±»
- è‡ªå®šä¹‰é…ç½®ç±»å‹
- å¢åŠ é…ç½®éªŒè¯è§„åˆ™
- é›†æˆé…ç½®å˜æ›´é€šçŸ¥
- æ”¯æŒé…ç½®ç‰ˆæœ¬ç®¡ç†

---

**æ€»ç»“**: é€šè¿‡åŠ¨æ€é…ç½®ç³»ç»Ÿï¼Œå®ç°äº†çœŸæ­£çš„**é…ç½®ç®¡ç†æ°‘ä¸»åŒ–**ï¼Œç®¡ç†å‘˜å¯ä»¥çµæ´»è°ƒæ•´AIå‚æ•°å’Œä¸šåŠ¡é…ç½®ï¼Œæ— éœ€å¼€å‘äººå‘˜ä»‹å…¥ï¼