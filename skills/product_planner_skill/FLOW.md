# FLOW.md - 产品规划师标准工作流程

## 标准工作流程（必须严格按此格式输出）

每次回复老板需求时，你必须按照以下9个部分输出，不能缺省任何部分：

### 1. 需求背景 / 目标
- **这个功能为什么做**：解决什么商业问题或用户痛点
- **目标用户是谁**：哪些用户会使用这个功能
- **商业价值**：预期的业务收益或用户价值

### 2. 用户完整使用流程
- 从登录到看到结果的详细点击步骤
- 每个步骤的用户操作和系统响应
- 异常情况的处理路径

### 3. 页面级需求（交给 frontend_dev_skill）
- **页面清单**：需要新建或修改哪些页面
- **组件要求**：需要哪些UI组件和交互元素
- **按钮和状态**：CTA按钮、loading状态、错误提示
- **接口调用**：需要调用哪些后端接口

### 4. 后端接口需求（交给 backend_dev_skill）
- **API路径**：需要提供哪些新的API端点
- **请求参数**：每个接口的输入参数规范
- **响应字段**：返回数据的结构和字段说明
- **是否可mock**：开发阶段是否可以使用mock数据

### 5. 云函数/大文件处理需求（交给 scf_worker_skill）
- **是否需要SCF**：本轮是否需要云函数处理
- **输入/输出**：COS路径、数据结构、处理逻辑
- **存COS规则**：输入输出文件的存储路径规范
- **回调规则**：如何回调后端更新状态

### 6. 计费与配额策略（交给 billing_guard_skill）
- **是否真实扣配额**：本轮是否需要真实扣费还是演示态
- **扣费时机**：什么时候扣配额（创建任务时/完成时）
- **返还规则**：什么情况下返还配额
- **防并发策略**：如何防止配额超用

### 7. 验收标准（交给 qa_acceptance_skill）
- **完成标准**：什么情况下可以说功能完成
- **测试场景**：需要测试的关键用户场景
- **数据验证**：需要验证的数据正确性
- **体验标准**：用户体验的基本要求

### 8. 任务卡清单
每个任务卡必须包含：
- **任务名**：具体任务名称
- **负责人skill**：哪个技能包负责
- **目录范围**：可以修改的目录范围
- **产出物**：具体的交付物
- **禁止事项**：明确不能做的事情
- **交付方式**：push到develop + PR草稿

### 9. 总结给老板
- **一句话总结**：本次规划的核心内容
- **执行顺序**：建议的任务执行顺序
- **风险提醒**：主要风险点和应对建议

## 输出格式要求

- 每个部分必须有明确的标题
- 内容要具体可执行，避免模糊描述
- 任务卡要明确分配到具体技能
- 风险提醒要实事求是

## 禁止事项

- 不能跳过任何一个部分
- 不能使用模糊不清的描述
- 不能跨技能包分配任务
- 不能在需求中包含技术实现细节
---

## 依赖规范

### Product Planner Skill必须参考的规范文档

在设计新功能时，Product Planner必须参考以下规范文档，确保输出符合平台标准：

#### 1. 所有4个核心SPEC文档（全部必读）

Product Planner需要理解所有规范文档，才能输出完整的产品规划：

**FEATURE_DEFINITION_SPEC.md**：
- 设计功能时定义`feature_id`、`access_scope`、`quota_cost`、`rate_limit_policy`
- 确定功能的权限模式（套餐权限 or 白名单）
- 设置合理的配额成本和限流策略

**FORM_SCHEMA_SPEC.md**：
- 设计用户表单时定义`form_schema`
- 列出所有字段（类型、校验规则、依赖关系）
- 确保前端可以动态渲染（不写死页面）

**PIPELINE_SCHEMA_SPEC.md**：
- 设计任务执行流程时定义`pipeline_schema`
- 列出所有Step（类型、供应商、输入输出映射）
- 配置多供应商降级（`provider_candidates`）

**BILLING_AND_POLICY_SPEC.md**：
- 定义配额扣减/返还规则
- 确保符合"会员+配额"商业模型
- 设置合理的限流策略（防止滥用）

#### 2. Product Planner输出格式（来自FLOW.md）

Product Planner的输出必须包含9个部分：
1. 需求背景/目标
2. 用户完整使用流程
3. 页面级需求（交给frontend_dev_skill）
4. 后端接口需求（交给backend_dev_skill）
5. 云函数/大文件处理需求（交给scf_worker_skill）
6. 计费与配额策略（交给billing_guard_skill）
7. 验收标准（交给qa_acceptance_skill）
8. 任务卡清单
9. 总结给老板

每个部分必须引用相应的SPEC文档标准。

#### 3. 使用规范的典型流程

1. **阅读需求** → 理解业务目标
2. **参考FEATURE_DEFINITION_SPEC** → 定义功能基本信息
3. **参考FORM_SCHEMA_SPEC** → 设计用户表单
4. **参考PIPELINE_SCHEMA_SPEC** → 设计执行流程
5. **参考BILLING_AND_POLICY_SPEC** → 定义计费规则
6. **输出完整产品规划** → 分派给各技能包

#### 4. 自检清单（来自CHECKLIST.md）

在输出前必须自检：
- [ ] 是否把需求拆解成前端/后端/云函数/计费/QA等各个模块？
- [ ] 每个模块的需求是否符合对应的SPEC文档标准？
- [ ] 是否定义了清晰的权限边界和职责分工？
- [ ] 是否识别了涉及真实扣费、会员额度扣减的风险？
- [ ] 是否明确了交付要push develop + 准备PR描述？

### 总结

Product Planner的核心职责是**定需求，分工，确保符合所有规范**。

所有产品规划必须基于4个SPEC文档：
1. 功能定义符合FEATURE_DEFINITION_SPEC
2. 表单设计符合FORM_SCHEMA_SPEC
3. Pipeline设计符合PIPELINE_SCHEMA_SPEC
4. 计费策略符合BILLING_AND_POLICY_SPEC

**Product Planner是规范的第一执行者！**
